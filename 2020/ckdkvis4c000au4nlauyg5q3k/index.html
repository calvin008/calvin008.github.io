<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>【实战】uni-app+unicloud仿奈雪的茶 | 王大合</title><meta name="description" content="uni-app-仿奈雪的茶小程序uni-app介绍uni-app 是一个使用 Vue.js 开发所有前端应用的框架，开发者编写一套代码，可发布到iOS、Android、H5、以及各种小程序（微信&#x2F;支付宝&#x2F;百度&#x2F;头条&#x2F;QQ&#x2F;钉钉&#x2F;淘宝）、快应用等多个平台。 uni-app在手，做啥都不愁。即使不跨端，uni-app也是更好的小程序开发框架（详见）、更好的App跨平台框架、更方便的H5开发框架。不管领"><meta name="author" content="王大合"><meta name="copyright" content="王大合"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://yoursite.com/2020/ckdkvis4c000au4nlauyg5q3k/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="【实战】uni-app+unicloud仿奈雪的茶"><meta property="og:url" content="http://yoursite.com/2020/ckdkvis4c000au4nlauyg5q3k/"><meta property="og:site_name" content="王大合"><meta property="og:description" content="uni-app-仿奈雪的茶小程序uni-app介绍uni-app 是一个使用 Vue.js 开发所有前端应用的框架，开发者编写一套代码，可发布到iOS、Android、H5、以及各种小程序（微信&#x2F;支付宝&#x2F;百度&#x2F;头条&#x2F;QQ&#x2F;钉钉&#x2F;淘宝）、快应用等多个平台。 uni-app在手，做啥都不愁。即使不跨端，uni-app也是更好的小程序开发框架（详见）、更好的App跨平台框架、更方便的H5开发框架。不管领"><meta property="og:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg"><meta property="article:published_time" content="2020-08-07T23:38:39.000Z"><meta property="article:modified_time" content="2020-08-07T23:40:47.290Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2020-08-08 07:40:47'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img {
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 5.0.0"><link rel="alternate" href="/atom.xml" title="王大合" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">4</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">2</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories"><i class="fa-fw fas fa-tags"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 视频教程</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/Hexo"><span> hexo</span></a></li><li><a class="site-page" href="/categories/Uni-app"><span> uni-app</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#uni-app-%E4%BB%BF%E5%A5%88%E9%9B%AA%E7%9A%84%E8%8C%B6%E5%B0%8F%E7%A8%8B%E5%BA%8F"><span class="toc-number">1.</span> <span class="toc-text">uni-app-仿奈雪的茶小程序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#uni-app%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.</span> <span class="toc-text">uni-app介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.1.</span> <span class="toc-text">项目介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%BB%BAuni-app%E9%A1%B9%E7%9B%AE%E4%BB%A5%E5%8F%8A%E9%A1%B9%E7%9B%AE%E7%9B%AE%E5%BD%95"><span class="toc-number">2.2.</span> <span class="toc-text">新建uni-app项目以及项目目录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%9B%AE%E5%BD%95%E8%AF%A6%E8%A7%A3"><span class="toc-number">2.2.1.</span> <span class="toc-text">项目目录详解</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEpages-json"><span class="toc-number">2.3.</span> <span class="toc-text">配置pages.json</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">2.4.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E6%A0%B7%E5%BC%8F"><span class="toc-number">2.5.</span> <span class="toc-text">全局样式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-1"><span class="toc-number">2.6.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#uni-app%E4%BD%BF%E7%94%A8iconfont"><span class="toc-number">2.7.</span> <span class="toc-text">uni-app使用iconfont</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E5%9C%A8uni-app%E4%B8%AD%E4%BD%BF%E7%94%A8vuex"><span class="toc-number">2.8.</span> <span class="toc-text">如何在uni-app中使用vuex</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#unicloud%E5%9F%BA%E7%A1%80"><span class="toc-number">3.</span> <span class="toc-text">unicloud基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#UNiCloud%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">3.1.</span> <span class="toc-text">UNiCloud云数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unicloud%E5%B0%8F%E6%A1%88%E4%BE%8B-%E7%95%99%E8%A8%80%E6%9D%BF"><span class="toc-number">3.2.</span> <span class="toc-text">unicloud小案例-留言板</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%91%E5%87%BD%E6%95%B0"><span class="toc-number">3.2.1.</span> <span class="toc-text">云函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%82%B9%E9%A4%90%E5%B0%8F%E7%A8%8B%E5%BA%8F%E9%A6%96%E9%A1%B5%E5%BC%80%E5%8F%91"><span class="toc-number">4.</span> <span class="toc-text">点餐小程序首页开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A6%96%E5%85%88%E6%98%AFbannar%E9%83%A8%E5%88%86%E5%BC%80%E5%8F%91"><span class="toc-number">4.1.</span> <span class="toc-text">首先是bannar部分开发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A6%96%E9%A1%B5intro"><span class="toc-number">4.2.</span> <span class="toc-text">首页intro</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-2"><span class="toc-number">4.3.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A6%96%E9%A1%B5-entrance%E5%A4%96%E5%8D%96%E5%92%8C%E7%82%B9%E9%A4%90%E5%85%A5%E5%8F%A3"><span class="toc-number">4.4.</span> <span class="toc-text">首页 entrance外卖和点餐入口</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%9A%E5%91%98%E7%A7%AF%E5%88%86%E6%A8%A1%E5%9D%97"><span class="toc-number">4.5.</span> <span class="toc-text">会员积分模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A5%88%E9%9B%AA%E5%95%86%E5%9F%8E%E4%BB%A5%E5%8F%8A%E4%BC%9A%E5%91%98%E6%96%B0%E9%97%BB"><span class="toc-number">4.6.</span> <span class="toc-text">奈雪商城以及会员新闻</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%99%BB%E5%BD%95%E5%BC%80%E5%8F%91"><span class="toc-number">5.</span> <span class="toc-text">微信小程序登录开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%99%BB%E5%BD%95%E5%8E%9F%E7%90%86"><span class="toc-number">5.1.</span> <span class="toc-text">微信小程序登录原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unicloud%E7%99%BB%E5%BD%95%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F"><span class="toc-number">5.2.</span> <span class="toc-text">unicloud登录微信小程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2login%E5%BC%80%E5%8F%91"><span class="toc-number">5.3.</span> <span class="toc-text">登录页面login开发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2login%E6%8E%A5%E5%8F%A3%E5%BC%80%E5%8F%91js%E5%92%8Cunicloud%E5%90%8E%E7%AB%AF%E4%BA%8B%E4%BB%B6"><span class="toc-number">5.4.</span> <span class="toc-text">登录页面login接口开发js和unicloud后端事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-3"><span class="toc-number">5.5.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#uniCloud%E5%90%8E%E7%AB%AF"><span class="toc-number">5.6.</span> <span class="toc-text">uniCloud后端</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AA%E4%BA%BA%E4%B8%AD%E5%BF%83%E9%A1%B5%E9%9D%A2%E5%BC%80%E5%8F%91"><span class="toc-number">6.</span> <span class="toc-text">个人中心页面开发</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%AA%E4%BA%BA%E4%B8%AD%E5%BF%83CSS%E6%A0%B7%E5%BC%8F"><span class="toc-number">6.0.1.</span> <span class="toc-text">个人中心CSS样式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%91%E7%9A%84%E5%9C%B0%E5%9D%80%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91"><span class="toc-number">7.</span> <span class="toc-text">我的地址模块开发</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#validateToken%E9%AA%8C%E8%AF%81"><span class="toc-number">7.0.1.</span> <span class="toc-text">validateToken验证</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#token"><span class="toc-number">7.0.2.</span> <span class="toc-text">token</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E5%88%97%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">7.0.3.</span> <span class="toc-text">地址列表查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E5%88%97%E8%A1%A8%E5%88%A0%E9%99%A4"><span class="toc-number">7.0.4.</span> <span class="toc-text">地址列表删除</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E6%96%B0%E5%A2%9E%E5%9C%B0%E5%9D%80"><span class="toc-number">7.0.5.</span> <span class="toc-text">用户新增地址</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7%E5%9C%B0%E5%9D%80"><span class="toc-number">7.0.6.</span> <span class="toc-text">修改用户地址</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-address-vue%E9%A1%B5%E9%9D%A2edit-%E8%A7%A6%E5%8F%91%E4%BA%8B%E4%BB%B6"><span class="toc-number">7.0.6.1.</span> <span class="toc-text">1.address.vue页面edit 触发事件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-edit-vue%E7%95%8C%E9%9D%A2"><span class="toc-number">7.0.6.2.</span> <span class="toc-text">2.edit.vue界面</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%91%E5%87%BD%E6%95%B0%E5%90%88%E5%B9%B6"><span class="toc-number">7.0.7.</span> <span class="toc-text">云函数合并</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%A8%E5%BA%97%E9%80%89%E6%8B%A9%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91"><span class="toc-number">8.</span> <span class="toc-text">门店选择模块开发</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A6%96%E5%85%88%E6%88%91%E4%BB%AC%E4%BA%86%E8%A7%A3%E4%B8%8B%E5%B0%8F%E7%A8%8B%E5%BA%8Fmap%E7%BB%84%E4%BB%B6"><span class="toc-number">8.0.1.</span> <span class="toc-text">首先我们了解下小程序map组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7%E4%BD%8D%E7%BD%AE"><span class="toc-number">8.0.2.</span> <span class="toc-text">小程序获取用户位置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#uni-app%E5%89%8D%E7%AB%AF%E5%B0%8F%E7%A8%8B%E5%BA%8F%E9%A1%B5%E9%9D%A2%E5%BC%80%E5%8F%91"><span class="toc-number">8.0.3.</span> <span class="toc-text">uni-app前端小程序页面开发</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E7%94%A8%E6%88%B7%E4%BD%8D%E7%BD%AE%E5%88%B0%E9%97%A8%E5%BA%97%E8%B7%9D%E7%A6%BB%E5%B9%B6%E4%B8%94%E6%8E%92%E5%BA%8F%E6%98%BE%E7%A4%BA%E6%9C%80%E8%BF%91%E7%9A%84%E9%97%A8%E5%BA%97%E5%9C%A8markers%E6%A0%87%E6%B3%A8%E4%B8%8A"><span class="toc-number">8.0.4.</span> <span class="toc-text">计算用户位置到门店距离并且排序显示最近的门店在markers标注上</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%82%B9%E9%A4%90%E8%8F%9C%E5%8D%95%E5%BC%80%E5%8F%91"><span class="toc-number">8.1.</span> <span class="toc-text">点餐菜单开发</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E8%88%AA%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91"><span class="toc-number">8.1.1.</span> <span class="toc-text">导航模块开发</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E8%8F%9C%E5%8D%95goods%E6%95%B0%E6%8D%AE"><span class="toc-number">8.1.2.</span> <span class="toc-text">加载菜单goods数据</span></a></li></ol></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">王大合</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/categories"><i class="fa-fw fas fa-tags"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 视频教程</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/Hexo"><span> hexo</span></a></li><li><a class="site-page" href="/categories/Uni-app"><span> uni-app</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">【实战】uni-app+unicloud仿奈雪的茶</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-08-07T23:38:39.000Z" title="发表于 2020-08-08 07:38:39">2020-08-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-08-07T23:40:47.290Z" title="更新于 2020-08-08 07:40:47">2020-08-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Uni-app/">Uni-app</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="uni-app-仿奈雪的茶小程序"><a href="#uni-app-仿奈雪的茶小程序" class="headerlink" title="uni-app-仿奈雪的茶小程序"></a>uni-app-仿奈雪的茶小程序</h2><h2 id="uni-app介绍"><a href="#uni-app介绍" class="headerlink" title="uni-app介绍"></a>uni-app介绍</h2><p><code>uni-app</code> 是一个使用 <a target="_blank" rel="noopener" href="https://vuejs.org/">Vue.js</a> 开发所有前端应用的框架，开发者编写一套代码，可发布到iOS、Android、H5、以及各种小程序（微信/支付宝/百度/头条/QQ/钉钉/淘宝）、快应用等多个平台。</p>
<p><code>uni-app</code>在手，做啥都不愁。即使不跨端，<code>uni-app</code>也是更好的小程序开发框架（<a target="_blank" rel="noopener" href="https://ask.dcloud.net.cn/article/35947">详见</a>）、更好的App跨平台框架、更方便的H5开发框架。不管领导安排什么样的项目，你都可以快速交付，不需要转换开发思维、不需要更改开发习惯。</p>
<h3 id="项目介绍"><a href="#项目介绍" class="headerlink" title="项目介绍"></a>项目介绍</h3><h3 id="新建uni-app项目以及项目目录"><a href="#新建uni-app项目以及项目目录" class="headerlink" title="新建uni-app项目以及项目目录"></a>新建uni-app项目以及项目目录</h3><p>目录结构：<a target="_blank" rel="noopener" href="https://uniapp.dcloud.io/frame">https://uniapp.dcloud.io/frame</a></p>
<h4 id="项目目录详解"><a href="#项目目录详解" class="headerlink" title="项目目录详解"></a>项目目录详解</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">┌─pages               </span><br><span class="line">│  ├─index</span><br><span class="line">│  │  └─index.vue    </span><br><span class="line">│  └─login</span><br><span class="line">│     └─login.vue    </span><br><span class="line">├─static             </span><br><span class="line">├─main.js       </span><br><span class="line">├─App.vue          </span><br><span class="line">├─manifest.json  </span><br><span class="line">└─pages.json            </span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="配置pages-json"><a href="#配置pages-json" class="headerlink" title="配置pages.json"></a>配置pages.json</h3><p><img src= "/img/loading.gif" data-lazy-src="/2020/ckdkvis4c000au4nlauyg5q3k/Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200604182843992.png" alt="image-20200604182843992"></p>
<h3 id><a href="#" class="headerlink" title></a></h3><h3 id="全局样式"><a href="#全局样式" class="headerlink" title="全局样式"></a>全局样式</h3><p>全局样式参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;* 全局色彩 *&#x2F;</span><br><span class="line">$color-primary: #ADB838;</span><br><span class="line">$color-success: #4cd964;</span><br><span class="line">$color-warning: #FAB714;</span><br><span class="line">$color-error: #D12E32;</span><br><span class="line"></span><br><span class="line">&#x2F;* 文字基本颜色 *&#x2F;</span><br><span class="line">$text-color-base: #5A5B5C; &#x2F;&#x2F;基本色</span><br><span class="line">$text-color-assist: #919293; &#x2F;&#x2F;辅助色</span><br><span class="line">$text-color-black: #3B3C3E; &#x2F;&#x2F;黑</span><br><span class="line">$text-color-grey: #878889; &#x2F;&#x2F;灰</span><br><span class="line">$text-color-white: #ffffff; &#x2F;&#x2F;白</span><br><span class="line"></span><br><span class="line">&#x2F;* 背景颜色 *&#x2F;</span><br><span class="line">$bg-color: #F1F8FA;</span><br><span class="line">$bg-color-grey: #F5F5F5;</span><br><span class="line">$bg-color-primary: #E8EACF;</span><br><span class="line"></span><br><span class="line">&#x2F;* 边框颜色 *&#x2F;</span><br><span class="line">$border-color:#e2e2e2;</span><br><span class="line"></span><br><span class="line">&#x2F;* 尺寸变量 *&#x2F;</span><br><span class="line"></span><br><span class="line">&#x2F;* 文字尺寸 *&#x2F;</span><br><span class="line">$font-size-sm:24rpx;</span><br><span class="line">$font-size-base:28rpx;</span><br><span class="line">$font-size-lg:32rpx;</span><br><span class="line"></span><br><span class="line">&#x2F;* 图片尺寸 *&#x2F;</span><br><span class="line">$img-size-sm:40rpx;</span><br><span class="line">$img-size-base:52rpx;</span><br><span class="line">$img-size-lg:80rpx;</span><br><span class="line"></span><br><span class="line">&#x2F;* Border Radius *&#x2F;</span><br><span class="line">$border-radius-sm: 4rpx;</span><br><span class="line">$border-radius-base: 6rpx;</span><br><span class="line">$border-radius-lg: 12rpx;</span><br><span class="line">$border-radius-circle: 50%;</span><br><span class="line"></span><br><span class="line">&#x2F;* 水平间距 *&#x2F;</span><br><span class="line">$spacing-row-sm: 10px;</span><br><span class="line">$spacing-row-base: 20rpx;</span><br><span class="line">$spacing-row-lg: 30rpx;</span><br><span class="line"></span><br><span class="line">&#x2F;* 垂直间距 *&#x2F;</span><br><span class="line">$spacing-col-sm: 8rpx;</span><br><span class="line">$spacing-col-base: 16rpx;</span><br><span class="line">$spacing-col-lg: 24rpx;</span><br><span class="line"></span><br><span class="line">&#x2F;* 透明度 *&#x2F;</span><br><span class="line">$opacity-disabled: 0.3; &#x2F;&#x2F; 组件禁用态的透明度</span><br><span class="line"></span><br><span class="line">&#x2F;* 文章场景相关 *&#x2F;</span><br><span class="line">$color-title: #2C405A; &#x2F;&#x2F; 文章标题颜色</span><br><span class="line">$font-size-title:40rpx;</span><br><span class="line">$color-subtitle: #555555; &#x2F;&#x2F; 二级标题颜色</span><br><span class="line">$font-size-subtitle:36rpx;</span><br><span class="line">$color-paragraph: #3F536E; &#x2F;&#x2F; 文章段落颜色</span><br><span class="line">$font-size-paragraph:30rpx;</span><br><span class="line"></span><br><span class="line">$box-shadow: 0 20rpx 20rpx -20rpx rgba($color: #333, $alpha: 0.1);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="-1"><a href="#-1" class="headerlink" title></a></h3><p>app.scss定义全局基础样式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br></pre></td><td class="code"><pre><span class="line">@import &#39;~@&#x2F;uni.scss&#39;;</span><br><span class="line"></span><br><span class="line">page,</span><br><span class="line">view,</span><br><span class="line">scroll-view,</span><br><span class="line">text,</span><br><span class="line">image,</span><br><span class="line">textarea,</span><br><span class="line">button,</span><br><span class="line">input &#123;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">page &#123;</span><br><span class="line">    background-color: #F1F8FA;</span><br><span class="line">    height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.container &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">button &#123;</span><br><span class="line">    margin: 0;</span><br><span class="line"></span><br><span class="line">    &amp;[type&#x3D;&#39;primary&#39;] &#123;</span><br><span class="line">        background-color: $color-primary;</span><br><span class="line">        color: #ffffff;</span><br><span class="line">        font-size: $font-size-base;</span><br><span class="line">        </span><br><span class="line">        &amp;[disabled] &#123;</span><br><span class="line">            background-color: #D1D78C;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        &amp;[plain] &#123;</span><br><span class="line">            color: $color-primary;</span><br><span class="line">            border: 1rpx solid $color-primary;</span><br><span class="line">        &#125;</span><br><span class="line">        &amp;.button-hover &#123;</span><br><span class="line">            background-color: #d5da91;</span><br><span class="line">        &#125;</span><br><span class="line">        &amp;::after &#123;</span><br><span class="line">            border: 0;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;[type&#x3D;&#39;default&#39;] &#123;</span><br><span class="line">        &amp;[plain] &#123;</span><br><span class="line">            color: $text-color-assist;</span><br><span class="line">            border: 1rpx solid $text-color-assist;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.bg-base &#123;</span><br><span class="line">    background-color: $bg-color;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.bg-white &#123;</span><br><span class="line">    background-color: #ffffff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.bg-transparent &#123;</span><br><span class="line">  background-color: transparent !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.bg-primary &#123;</span><br><span class="line">    background-color: $color-primary;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.bg-warning &#123;</span><br><span class="line">    background-color: $color-warning;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.d-flex &#123;</span><br><span class="line">    display: flex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.d-none &#123;</span><br><span class="line">    display: none !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.invisible &#123;</span><br><span class="line">  visibility: hidden !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.d-inline &#123;</span><br><span class="line">    display: inline !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.d-inline-block &#123;</span><br><span class="line">    display: inline-block !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.d-block &#123;</span><br><span class="line">    display: block !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.flex-column &#123;</span><br><span class="line">    -ms-flex-direction: column !important;</span><br><span class="line">    flex-direction: column !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.justify-content-start &#123;</span><br><span class="line">    justify-content: flex-start;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.justify-content-end &#123;</span><br><span class="line">    justify-content: flex-end;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.justify-content-between &#123;</span><br><span class="line">    justify-content: space-between;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.just-content-center &#123;</span><br><span class="line">    justify-content: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.justify-content-evenly &#123;</span><br><span class="line">    justify-content: space-evenly !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.just-content-around &#123;</span><br><span class="line">    justify-content: space-around;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.align-items-start &#123;</span><br><span class="line">    align-items: flex-start;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.align-items-end &#123;</span><br><span class="line">    align-items: flex-end;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.align-items-center &#123;</span><br><span class="line">    align-items: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.align-items-between &#123;</span><br><span class="line">    align-items: space-between;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.align-items-around &#123;</span><br><span class="line">    align-items: space-around;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.align-items-stretch &#123;</span><br><span class="line">    align-items: stretch;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.align-items-baseline &#123;</span><br><span class="line">    -ms-flex-align: baseline !important;</span><br><span class="line">    align-items: baseline !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.flex-fill &#123;</span><br><span class="line">    -ms-flex: 1 1 auto !important;</span><br><span class="line">    flex: 1 1 auto !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.flex-wrap &#123;</span><br><span class="line">    -ms-flex-wrap: wrap !important;</span><br><span class="line">    flex-wrap: wrap !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.flex-nowrap &#123;</span><br><span class="line">    -ms-flex-wrap: nowrap !important;</span><br><span class="line">    flex-wrap: nowrap !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.flex-shrink-0 &#123;</span><br><span class="line">    -ms-flex-negative: 0 !important;</span><br><span class="line">    flex-shrink: 0 !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.font-size-base &#123;</span><br><span class="line">    font-size: 28rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.font-size-sm &#123;</span><br><span class="line">    font-size: 24rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.font-size-medium &#123;</span><br><span class="line">    font-size: 26rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.font-size-lg &#123;</span><br><span class="line">    font-size: 32rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.font-size-extra-lg &#123;</span><br><span class="line">    font-size: 40rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.text-color-base &#123;</span><br><span class="line">    color: $text-color-base;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.text-color-assist &#123;</span><br><span class="line">    color: $text-color-assist;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.text-color-primary &#123;</span><br><span class="line">    color: $color-primary;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.text-color-danger &#123;</span><br><span class="line">    color: $color-error;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.text-color-white &#123;</span><br><span class="line">    color: #ffffff;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.text-color-warning &#123;</span><br><span class="line">    color: $color-warning;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.text-truncate &#123;</span><br><span class="line">    overflow: hidden;</span><br><span class="line">    text-overflow: ellipsis;</span><br><span class="line">    white-space: nowrap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.font-weight-bold &#123;</span><br><span class="line">    font-weight: 700 !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.font-weight-light &#123;</span><br><span class="line">    font-weight: 300 !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.font-weight-lighter &#123;</span><br><span class="line">    font-weight: lighter !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.font-weight-normal &#123;</span><br><span class="line">    font-weight: 400 !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.overflow-auto &#123;</span><br><span class="line">    overflow: auto !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.overflow-hidden &#123;</span><br><span class="line">    overflow: hidden !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.position-relative &#123;</span><br><span class="line">    position: relative !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.position-absolute &#123;</span><br><span class="line">    position: absolute !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.position-fixed &#123;</span><br><span class="line">    position: fixed !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.fixed-top &#123;</span><br><span class="line">    position: fixed;</span><br><span class="line">    top: 0;</span><br><span class="line">    right: 0;</span><br><span class="line">    left: 0;</span><br><span class="line">    z-index: 1030;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.fixed-bottom &#123;</span><br><span class="line">    position: fixed;</span><br><span class="line">    right: 0;</span><br><span class="line">    bottom: 0;</span><br><span class="line">    left: 0;</span><br><span class="line">    z-index: 1030;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.line-height-100 &#123;</span><br><span class="line">    line-height: 100%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.line-height-2 &#123;</span><br><span class="line">    line-height: 2rem !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.line-height-50 &#123;</span><br><span class="line">    line-height: 50rem !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.w-25 &#123;</span><br><span class="line">    width: 25% !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.w-50 &#123;</span><br><span class="line">    width: 50% !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.w-75 &#123;</span><br><span class="line">    width: 75% !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.w-80 &#123;</span><br><span class="line">    width: 80% !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.w-100 &#123;</span><br><span class="line">    width: 100% !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.h-100 &#123;</span><br><span class="line">    height: 100% !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.text-left &#123;</span><br><span class="line">    text-align: left !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.text-right &#123;</span><br><span class="line">    text-align: right !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.text-center &#123;</span><br><span class="line">    text-align: center !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.border-box &#123;</span><br><span class="line">    box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.rounded-circle &#123;</span><br><span class="line">    border-radius: 50% !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.rounded-pill &#123;</span><br><span class="line">    border-radius: 50rem !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.pre-line &#123;</span><br><span class="line">    white-space: pre-line;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.align-top &#123;</span><br><span class="line">    vertical-align: top !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.align-middle &#123;</span><br><span class="line">    vertical-align: middle !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.align-bottom &#123;</span><br><span class="line">    vertical-align: bottom !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.align-text-bottom &#123;</span><br><span class="line">    vertical-align: text-bottom !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.align-text-top &#123;</span><br><span class="line">    vertical-align: text-top !important;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.w-60 &#123;</span><br><span class="line">    width: 60%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.w-40 &#123;</span><br><span class="line">    width: 40%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.mb-10 &#123;</span><br><span class="line">    margin-bottom: 10rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.mb-20 &#123;</span><br><span class="line">    margin-bottom: 20rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.mb-30 &#123;</span><br><span class="line">    margin-bottom: 30rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.mb-40 &#123;</span><br><span class="line">    margin-bottom: 40rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.mb-50 &#123;</span><br><span class="line">    margin-bottom: 50rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.mt-30 &#123;</span><br><span class="line">    margin-top: 30rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ml-10 &#123;</span><br><span class="line">    margin-left: 10rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ml-20 &#123;</span><br><span class="line">    margin-left: 20rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.ml-30 &#123;</span><br><span class="line">    margin-left: 30rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.mr-10 &#123;</span><br><span class="line">    margin-right: 10rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.mr-20 &#123;</span><br><span class="line">    margin-right: 20rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.mr-30 &#123;</span><br><span class="line">    margin-right: 30rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.mr-40 &#123;</span><br><span class="line">    margin-right: 40rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.pl-30 &#123;</span><br><span class="line">    padding-left: 30rpx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>工具 -加载scss预编辑器插件</p>
<p>然后在App.vue 中 import app.scss</p>
<h3 id="uni-app使用iconfont"><a href="#uni-app使用iconfont" class="headerlink" title="uni-app使用iconfont"></a>uni-app使用iconfont</h3><p>1.iconfont网站选取需要的icon，放入购物车，然后导出</p>
<p>2.拷贝iconfont.css放到项目目录当中</p>
<p>3.复制UNIcoud(在iconfont官网)</p>
<h3 id="如何在uni-app中使用vuex"><a href="#如何在uni-app中使用vuex" class="headerlink" title="如何在uni-app中使用vuex"></a>如何在uni-app中使用vuex</h3><p>由于uni-app已经内置了vuex，所以只要正确引入就好了。</p>
<p>1、在项目的根目录下，<strong>创建一个名为store的文件夹</strong>然后在该文件夹下创建一个<strong>index.js</strong>的js文件<br> 2、在该js文件下定义公共的数据以及方法函数，并且把它导出</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">    state: &#123;&#125;,</span><br><span class="line">    mutations: &#123;&#125;,</span><br><span class="line">    actions: &#123;&#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure>

<p>3、在入口文件即：<strong>main.js</strong>挂载vuex</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&#x27;./App&#x27;</span></span><br><span class="line"><span class="comment">//引入vuex</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line"><span class="comment">//把vuex定义成全局组件</span></span><br><span class="line">Vue.prototype.$store = store</span><br><span class="line">Vue.config.productionTip = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">App.mpType = <span class="string">&#x27;app&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    ...App,</span><br><span class="line"><span class="comment">//挂载</span></span><br><span class="line">    store</span><br><span class="line">&#125;)</span><br><span class="line">app.$mount()</span><br></pre></td></tr></table></figure>







<p>引入store中isLogin和orderType</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import Vue from &#39;vue&#39;</span><br><span class="line">import Vuex from &#39;vuex&#39;</span><br><span class="line">Vue.use(Vuex)</span><br><span class="line">const store &#x3D; new Vuex.Store(&#123;</span><br><span class="line">    state: &#123;</span><br><span class="line">        isLogin:false,</span><br><span class="line">        orderType: &#39;takein&#39;</span><br><span class="line">    &#125;,</span><br><span class="line">    mutations: &#123;</span><br><span class="line">        SET_ORDERTYPE(state,type) &#123;</span><br><span class="line">            state.orderType &#x3D; type</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    actions: &#123;&#125;</span><br><span class="line">&#125;)</span><br><span class="line">export default store</span><br></pre></td></tr></table></figure>

<p>项目中</p>
<p>第一步 script中引入</p>
<p>import {mapState} from ‘vuex’</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> 在计算属性中引入</span><br><span class="line">...mapState([ &#x27;isLogin&#x27;, &#x27;orderType&#x27;]) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">takein() &#123;</span><br><span class="line">                this.$store.commit(&#x27;SET_ORDER_TYPE&#x27;, &#x27;takein&#x27;)</span><br><span class="line">                uni.switchTab(&#123;</span><br><span class="line">                    url: &#x27;/pages/menu/menu&#x27;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;,</span><br></pre></td></tr></table></figure>

<h2 id="unicloud基础"><a href="#unicloud基础" class="headerlink" title="unicloud基础"></a>unicloud基础</h2><h3 id="UNiCloud云数据库"><a href="#UNiCloud云数据库" class="headerlink" title="UNiCloud云数据库"></a>UNiCloud云数据库</h3><p>​    </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&quot;userName&quot;:&quot;calvin&quot;,</span><br><span class="line">&quot;password&quot;:123456,</span><br><span class="line">&quot;gender&quot;: 1,</span><br><span class="line">&quot;avatarUrl&quot;:&quot;https:&#x2F;&#x2F;wx.qlogo.cn&#x2F;mmopen&#x2F;vi_32&#x2F;DYAIOgq83erykAZZqzQLTpO7EzXeqCaWreYwt8DuN0cgogux92HTlKR8gKiaqQNYf4kyBsqgmh99qNLrgaziaJbg&#x2F;132&quot;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>云函数中引入database即可操作数据库</p>
<p>const db = uniCloud.database();</p>
<p>即可使用数据库</p>
<h3 id="unicloud小案例-留言板"><a href="#unicloud小案例-留言板" class="headerlink" title="unicloud小案例-留言板"></a>unicloud小案例-留言板</h3><p>前端</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;view class&#x3D;&quot;content&quot;&gt;</span><br><span class="line">        &lt;view class&#x3D;&quot;input_box&quot;&gt;</span><br><span class="line">            &lt;textarea placeholder&#x3D;&quot;请输入您要留言的内容&quot; class&#x3D;&quot;textarea border&quot; v-model&#x3D;&quot;list.content&quot;&gt;&lt;&#x2F;textarea&gt;</span><br><span class="line">            &lt;input type&#x3D;&quot;text&quot; class&#x3D;&quot;input_box border&quot; v-model&#x3D;&quot;list.name&quot; placeholder&#x3D;&quot;请输入用户名:&quot; &#x2F;&gt;</span><br><span class="line">            &lt;button @click&#x3D;&quot;Add&quot; class&#x3D;&quot;submit&quot;&gt;提交&lt;&#x2F;button&gt;</span><br><span class="line">        &lt;&#x2F;view&gt;</span><br><span class="line"></span><br><span class="line">        &lt;view class&#x3D;&quot;list&quot;&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;item&quot; v-for&#x3D;&quot;(item, index) in listData&quot; :key&#x3D;&quot;index&quot;&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;word&quot;&gt;</span><br><span class="line">                    &lt;text class&#x3D;&quot;user_name&quot;&gt;&#123;&#123; item.name &#125;&#125;&lt;&#x2F;text&gt;</span><br><span class="line">                    &lt;text class&#x3D;&quot;content&quot;&gt;&#123;&#123; item.content &#125;&#125;&lt;&#x2F;text&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;text class&#x3D;&quot;delete&quot;  @click&#x3D;&quot;remove(item._id)&quot;&gt;删除&lt;&#x2F;text&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">        &lt;&#x2F;view&gt;</span><br><span class="line">    &lt;&#x2F;view&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            list: &#123;</span><br><span class="line">                    name:&quot;&quot;,</span><br><span class="line">                    content: &quot;&quot;</span><br><span class="line">                &#125;,</span><br><span class="line">            listData:[</span><br><span class="line">                &#123;    </span><br><span class="line">                    _id:&quot;&quot;,</span><br><span class="line">                    name:&quot;&quot;,</span><br><span class="line">                    content: &quot;&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    onLoad() &#123;</span><br><span class="line">        this.getData()</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        Add() &#123;</span><br><span class="line">            let data &#x3D; this.list;</span><br><span class="line">            uniCloud.callFunction(&#123;</span><br><span class="line">                name:&#39;add&#39;,</span><br><span class="line">                data: data</span><br><span class="line">            &#125;).then((res)&#x3D;&gt;&#123;</span><br><span class="line">                this.getData()</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;,</span><br><span class="line">        getData() &#123;</span><br><span class="line">            uniCloud.callFunction(&#123;</span><br><span class="line">                name:&#39;get&#39;</span><br><span class="line">            &#125;).then((res)&#x3D;&gt;&#123;</span><br><span class="line">                this.listData &#x3D; res.result.data</span><br><span class="line">            &#125;)</span><br><span class="line">            </span><br><span class="line">        &#125;,</span><br><span class="line">        remove(id)&#123;</span><br><span class="line">            let _id &#x3D; id</span><br><span class="line">            uniCloud.callFunction(&#123;</span><br><span class="line">                name:&#39;remove&#39;,</span><br><span class="line">                data:&#123;</span><br><span class="line">                    _id</span><br><span class="line">                &#125;</span><br><span class="line">                 </span><br><span class="line">            &#125;).then((res)&#x3D;&gt;&#123;</span><br><span class="line">                this.getData()</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">.border &#123;</span><br><span class="line">    border-style: solid;</span><br><span class="line">    border-width: 1px;</span><br><span class="line">    border-color: #eeeeee;</span><br><span class="line">&#125;</span><br><span class="line">.input &#123;</span><br><span class="line">    padding: 6rpx 8rpx;</span><br><span class="line">    height: 42px;</span><br><span class="line">    margin: 10rpx;</span><br><span class="line">&#125;</span><br><span class="line">.submit &#123;</span><br><span class="line">    width: 400upx;</span><br><span class="line">    margin-left: 175rpx;</span><br><span class="line">    margin-top: 10px;</span><br><span class="line">    margin-bottom: 20px;</span><br><span class="line">&#125;</span><br><span class="line">.delete &#123;</span><br><span class="line">    background-color: #dddddd;</span><br><span class="line">    color: #ffffff;</span><br><span class="line">    width: 40rpx;</span><br><span class="line">    line-height: 50rpx;</span><br><span class="line">    height: 50rpx;</span><br><span class="line">    text-align: center;</span><br><span class="line">    width: 80rpx;</span><br><span class="line">    font-size: 30rpx;</span><br><span class="line">    border-radius: 6px;</span><br><span class="line">&#125;</span><br><span class="line">.list &#123;</span><br><span class="line">    width: 750rpx;</span><br><span class="line">&#125;</span><br><span class="line">.input_box &#123;</span><br><span class="line">    width: 750rpx;</span><br><span class="line">    background-color: #ffffff;</span><br><span class="line">    margin-bottom: 6px;</span><br><span class="line">&#125;</span><br><span class="line">.textarea &#123;</span><br><span class="line">    width: 730rpx;</span><br><span class="line">    padding: 10rpx;</span><br><span class="line">    margin: 10rpx;</span><br><span class="line">&#125;</span><br><span class="line">.item &#123;</span><br><span class="line">    @extend .border;</span><br><span class="line">    border-radius: 16px;</span><br><span class="line">    border-color: #eeeeee;</span><br><span class="line">    padding: 4px 8px;</span><br><span class="line">    margin: 5px;</span><br><span class="line">    flex-direction: row;</span><br><span class="line">    align-items: center;</span><br><span class="line">&#125;</span><br><span class="line">.logo &#123;</span><br><span class="line">    width: 100rpx;</span><br><span class="line">    height: 100rpx;</span><br><span class="line">    border-radius: 100px;</span><br><span class="line">&#125;</span><br><span class="line">.word &#123;</span><br><span class="line">    padding: 20rpx;</span><br><span class="line">    flex: 1;</span><br><span class="line">    justify-content: space-around;</span><br><span class="line">&#125;</span><br><span class="line">.user_name &#123;</span><br><span class="line">    font-size: 28upx;</span><br><span class="line">    color: #007aff;</span><br><span class="line">&#125;</span><br><span class="line">.content &#123;</span><br><span class="line">    font-size: 38upx;</span><br><span class="line">    color: #666666;</span><br><span class="line">&#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="云函数"><a href="#云函数" class="headerlink" title="云函数"></a>云函数</h4><p>添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#39;use strict&#39;;</span><br><span class="line">const db &#x3D; uniCloud.database()</span><br><span class="line">exports.main &#x3D; async (event, context) &#x3D;&gt; &#123;</span><br><span class="line">    const collection &#x3D; db.collection(&#39;list&#39;)</span><br><span class="line">    const res &#x3D; await collection.add(event)</span><br><span class="line">    return res</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>查找</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#39;use strict&#39;;</span><br><span class="line">const db &#x3D; uniCloud.database()</span><br><span class="line">exports.main &#x3D; async (event, context) &#x3D;&gt; &#123;</span><br><span class="line">    const collection &#x3D; db.collection(&#39;list&#39;)</span><br><span class="line">    &#x2F;&#x2F;const res &#x3D; await collection.limit(10).where().get()</span><br><span class="line">    const res &#x3D; await collection.orderBy(&quot;_id&quot;, &quot;desc&quot;).get()</span><br><span class="line">    return res</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>删除</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#39;use strict&#39;;</span><br><span class="line">const db &#x3D; uniCloud.database()</span><br><span class="line">exports.main &#x3D; async (event, context) &#x3D;&gt; &#123;</span><br><span class="line">    console.log(event);</span><br><span class="line">    db.collection(&#39;list&#39;).where(&#123;</span><br><span class="line">        _id: event._id</span><br><span class="line">    &#125;).remove().then(function(res) &#123;</span><br><span class="line">        if (res.deleted &#x3D;&#x3D;&#x3D; 1) &#123;</span><br><span class="line">          return &#123;</span><br><span class="line">            status: 0,</span><br><span class="line">            msg: &#39;成功删除unicloud-test内第一条数据&#39;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">          return &#123;</span><br><span class="line">            status: -2,</span><br><span class="line">            msg: &#39;删除数据失败&#39;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="点餐小程序首页开发"><a href="#点餐小程序首页开发" class="headerlink" title="点餐小程序首页开发"></a>点餐小程序首页开发</h2><h3 id="首先是bannar部分开发"><a href="#首先是bannar部分开发" class="headerlink" title="首先是bannar部分开发"></a><strong>首先是bannar部分开发</strong></h3><p>引入首图 <a target="_blank" rel="noopener" href="https://img-shop.qmimg.cn/s23107/2020/04/26/3eb7808bf105262604.jpg">https://img-shop.qmimg.cn/s23107/2020/04/26/3eb7808bf105262604.jpg</a></p>
<h3 id="首页intro"><a href="#首页intro" class="headerlink" title="首页intro"></a>首页intro</h3><p>导言部分</p>
<p>您好，游客</p>
<p>一杯奶茶，一口软欧包，在奈雪遇见两种美好</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class&#x3D;&quot;intro&quot;&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;greet&quot;&gt;您好，&#123;&#123; isLogin ? member.nickname : &#39;游客&#39; &#125;&#125;&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;note&quot;&gt;一杯奶茶，一口软欧包，在奈雪遇见两种美好&lt;&#x2F;view&gt;</span><br><span class="line">&lt;&#x2F;view&gt;</span><br></pre></td></tr></table></figure>

<p>css样式变量</p>
<p>var(–status-bar-height)</p>
<h3 id="-2"><a href="#-2" class="headerlink" title></a></h3><h3 id="首页-entrance外卖和点餐入口"><a href="#首页-entrance外卖和点餐入口" class="headerlink" title="首页 entrance外卖和点餐入口"></a>首页 entrance外卖和点餐入口</h3><p><strong>样式</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">.entrance &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    margin-top: -80rpx;</span><br><span class="line">    margin-bottom: 30rpx;</span><br><span class="line">    border-radius: 10rpx;</span><br><span class="line">    background-color: #ffffff;</span><br><span class="line">    box-shadow: $box-shadow;</span><br><span class="line">    padding: 30rpx 0;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    .item &#123;</span><br><span class="line">        flex: 1;</span><br><span class="line">        display: flex;</span><br><span class="line">        flex-direction: column;</span><br><span class="line">        justify-content: center;</span><br><span class="line">        align-items: center;</span><br><span class="line">        position: relative;</span><br><span class="line">        </span><br><span class="line">        &amp;:nth-child(1):after &#123;</span><br><span class="line">            content: &#39;&#39;;</span><br><span class="line">            position: absolute;</span><br><span class="line">            width: 1rpx;</span><br><span class="line">            background-color: $text-color-assist;</span><br><span class="line">            right: 0;</span><br><span class="line">            height: 100%;</span><br><span class="line">            transform: scaleX(0.5) scaleY(0.8);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .icon &#123;</span><br><span class="line">            width: 84rpx;</span><br><span class="line">            height: 84rpx;</span><br><span class="line">            margin: 20rpx;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .title &#123;</span><br><span class="line">            font-size: 30rpx;</span><br><span class="line">            color: $text-color-base;</span><br><span class="line">            font-weight: 600;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>布局</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class&#x3D;&quot;entrance&quot;&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;item&quot; @tap&#x3D;&quot;takein&quot;&gt;</span><br><span class="line">                    &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;index&#x2F;zq.png&quot; class&#x3D;&quot;icon&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;title&quot;&gt;自取&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;item&quot; @tap&#x3D;&quot;takeout&quot;&gt;</span><br><span class="line">                    &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;index&#x2F;wm.png&quot; class&#x3D;&quot;icon&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;title&quot;&gt;外卖&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">&lt;&#x2F;view&gt;</span><br></pre></td></tr></table></figure>



<h3 id="会员积分模块"><a href="#会员积分模块" class="headerlink" title="会员积分模块"></a>会员积分模块</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class&#x3D;&quot;info&quot;&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;integral_section&quot; @tap&#x3D;&quot;integrals&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;top&quot;&gt;</span><br><span class="line">                        &lt;text class&#x3D;&quot;title&quot;&gt;我的积分&lt;&#x2F;text&gt;</span><br><span class="line">                        &lt;text class&#x3D;&quot;value&quot;&gt;&#123;&#123; isLogin ? userInfo.pointNum : 0 &#125;&#125;&lt;&#x2F;text&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;bottom&quot;&gt;</span><br><span class="line">                        进入积分商城兑换奈雪券及周边好礼</span><br><span class="line">                        &lt;view class&#x3D;&quot;iconfont iconarrow-right&quot;&gt;&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;qrcode_section&quot; @tap&#x3D;&quot;memberCode&quot;&gt;</span><br><span class="line">                    &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;index&#x2F;qrcode.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                    &lt;text&gt;会员码&lt;&#x2F;text&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br></pre></td></tr></table></figure>

<p>CSS样式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 用户积分</span><br><span class="line">    .info &#123;</span><br><span class="line">        position: relative;</span><br><span class="line">        margin-bottom: 30rpx;</span><br><span class="line">        border-radius: 10rpx;</span><br><span class="line">        background-color: #ffffff;</span><br><span class="line">        box-shadow: $box-shadow;</span><br><span class="line">        padding: 30rpx;</span><br><span class="line">        display: flex;</span><br><span class="line">        align-items: center;</span><br><span class="line">        justify-content: center;</span><br><span class="line">        </span><br><span class="line">        .integral_section &#123;</span><br><span class="line">            flex: 1;</span><br><span class="line">            display: flex;</span><br><span class="line">            flex-direction: column;</span><br><span class="line">            justify-content: center;</span><br><span class="line">            </span><br><span class="line">            .top &#123;</span><br><span class="line">                display: flex;</span><br><span class="line">                align-items: center;</span><br><span class="line">                </span><br><span class="line">                .title &#123;</span><br><span class="line">                    color: $text-color-base;</span><br><span class="line">                    font-size: $font-size-base;</span><br><span class="line">                    margin-right: 10rpx;</span><br><span class="line">                &#125;</span><br><span class="line">                .value &#123;</span><br><span class="line">                    font-size: 44rpx;</span><br><span class="line">                    font-weight: bold;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .bottom &#123;</span><br><span class="line">                font-size: $font-size-sm;</span><br><span class="line">                color: $text-color-assist;</span><br><span class="line">                display: flex;</span><br><span class="line">                align-items: center;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .qrcode_section &#123;</span><br><span class="line">            color: $color-primary;</span><br><span class="line">            display: flex;</span><br><span class="line">            flex-direction: column;</span><br><span class="line">            align-items: center;</span><br><span class="line">            justify-content: center;</span><br><span class="line">            font-size: $font-size-sm;</span><br><span class="line">            </span><br><span class="line">            image &#123;</span><br><span class="line">                width: 40rpx;</span><br><span class="line">                height: 40rpx;</span><br><span class="line">                margin-bottom: 10rpx;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">memberCode() &#123;</span><br><span class="line">                if(!this.isLogin) &#123;</span><br><span class="line">                    uni.navigateTo(&#123;url: &#39;&#x2F;pages&#x2F;login&#x2F;login&#39;&#125;)</span><br><span class="line">                    return</span><br><span class="line">                &#125;</span><br><span class="line">                uni.navigateTo(&#123;</span><br><span class="line">                    url: &#39;&#x2F;pages&#x2F;mine&#x2F;member-code&#39;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;,</span><br></pre></td></tr></table></figure>

<h3 id="奈雪商城以及会员新闻"><a href="#奈雪商城以及会员新闻" class="headerlink" title="奈雪商城以及会员新闻"></a>奈雪商城以及会员新闻</h3><p>样式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;奈雪商城茶包</span><br><span class="line">    .navigators &#123;</span><br><span class="line">        width: 100%;</span><br><span class="line">        margin-bottom: 20rpx;    </span><br><span class="line">        border-radius: 10rpx;</span><br><span class="line">        background-color: #ffffff;</span><br><span class="line">        box-shadow: $box-shadow;</span><br><span class="line">        padding: 20rpx;</span><br><span class="line">        display: flex;</span><br><span class="line">        align-items: stretch;</span><br><span class="line">        </span><br><span class="line">        .left &#123;</span><br><span class="line">            width: 340rpx;</span><br><span class="line">            margin-right: 20rpx;</span><br><span class="line">            display: flex;</span><br><span class="line">            padding: 20rpx;</span><br><span class="line">            flex-direction: column;</span><br><span class="line">            font-size: $font-size-sm;</span><br><span class="line">            color: $text-color-base;</span><br><span class="line">            background-color: #F2F2E6;</span><br><span class="line">            </span><br><span class="line">            .grid &#123;</span><br><span class="line">                height: 50%;</span><br><span class="line">                display: flex;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .right &#123;</span><br><span class="line">            width: 290rpx;</span><br><span class="line">            display: flex;</span><br><span class="line">            flex-direction: column;</span><br><span class="line">            </span><br><span class="line">            .tea-activity, .member-gifts &#123;</span><br><span class="line">                width: 100%;</span><br><span class="line">                display: flex;</span><br><span class="line">                padding: 20rpx;</span><br><span class="line">                font-size: $font-size-sm;</span><br><span class="line">                color: $text-color-base;</span><br><span class="line">                align-items: center;</span><br><span class="line">                position: relative;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .tea-activity &#123;</span><br><span class="line">                background-color: #FDF3F2;</span><br><span class="line">                margin-bottom: 20rpx;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .member-gifts &#123;</span><br><span class="line">                background-color: #FCF6D4;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .right-img &#123;</span><br><span class="line">                flex: 1;</span><br><span class="line">                position: relative;</span><br><span class="line">                margin-left: 20rpx;</span><br><span class="line">                margin-right: -20rpx;</span><br><span class="line">                margin-bottom: -20rpx;</span><br><span class="line">                display: flex;</span><br><span class="line">                align-items: flex-end;</span><br><span class="line">                </span><br><span class="line">                image &#123;</span><br><span class="line">                    width: 100%;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .mark-img &#123;</span><br><span class="line">            width: 30rpx;</span><br><span class="line">            height: 30rpx;</span><br><span class="line">            margin-right: 10rpx;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .yzclh-img &#123;</span><br><span class="line">            height: 122.96rpx;</span><br><span class="line">            width: 214.86rpx;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    .member-news &#123;</span><br><span class="line">        width: 100%;</span><br><span class="line">        margin-bottom: 30rpx;</span><br><span class="line">        .header &#123;</span><br><span class="line">            display: flex;</span><br><span class="line">            align-items: center;</span><br><span class="line">            justify-content: space-between;</span><br><span class="line">            padding: 20rpx 0;</span><br><span class="line">            </span><br><span class="line">            .title &#123;</span><br><span class="line">                font-size: $font-size-lg;</span><br><span class="line">                font-weight: bold;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .iconfont &#123;</span><br><span class="line">                font-size: 52rpx;</span><br><span class="line">                color: $text-color-assist;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .list &#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">            display: flex;</span><br><span class="line">            flex-direction: column;</span><br><span class="line">            </span><br><span class="line">            .item &#123;</span><br><span class="line">                width: 100%;</span><br><span class="line">                height: 240rpx;</span><br><span class="line">                position: relative;</span><br><span class="line">                </span><br><span class="line">                image &#123;</span><br><span class="line">                    width: 100%;</span><br><span class="line">                    height: 100%;</span><br><span class="line">                    border-radius: 8rpx;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                .title &#123;</span><br><span class="line">                    position: relative;</span><br><span class="line">                    font-size: 32rpx;</span><br><span class="line">                    font-weight: 500;</span><br><span class="line">                    width: 100%;</span><br><span class="line">                    top: -70rpx;</span><br><span class="line">                    left: 16rpx;</span><br><span class="line">                    color: #ffffff;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>view文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 奈雪茶商城 --&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;navigators&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;left&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;grid flex-column just-content-center&quot;&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;d-flex align-items-center&quot;&gt;</span><br><span class="line">                                &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;index&#x2F;csc.png&quot; class&#x3D;&quot;mark-img&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                                &lt;view class&#x3D;&quot;font-size-sm text-color-base&quot;&gt;奈雪的茶商城&lt;&#x2F;view&gt;</span><br><span class="line">                            &lt;&#x2F;view&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;text-color-assist&quot; style&#x3D;&quot;margin-left: 40rpx; font-size: 20rpx;&quot;&gt;优质茶礼盒，网红零食&lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;grid justify-content-end align-items-end&quot;&gt;</span><br><span class="line">                            &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;index&#x2F;yzclh.png&quot; class&#x3D;&quot;yzclh-img&quot; mode&#x3D;&quot;heightFix&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;right&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;tea-activity&quot; @tap&#x3D;&quot;invite&quot;&gt;</span><br><span class="line">                            &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;index&#x2F;mcsb.png&quot; class&#x3D;&quot;mark-img&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                            &lt;view&gt;买茶送包&lt;&#x2F;view&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;right-img&quot;&gt;</span><br><span class="line">                                &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;index&#x2F;mcsb_bg.png&quot; mode&#x3D;&quot;widthFix&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                            &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;member-gifts&quot; @tap&#x3D;&quot;packages&quot;&gt;</span><br><span class="line">                            &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;index&#x2F;hyjb.png&quot; class&#x3D;&quot;mark-img&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                            &lt;view&gt;会员劵包&lt;&#x2F;view&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;right-img&quot;&gt;</span><br><span class="line">                                &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;index&#x2F;hyjb_bg.png&quot; mode&#x3D;&quot;widthFix&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                            &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;member-news&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;header&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;title&quot;&gt;会员新鲜事&lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;iconfont iconRightbutton&quot;&gt;&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;list&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;item&quot;&gt;</span><br><span class="line">                            &lt;image src&#x3D;&quot;https:&#x2F;&#x2F;img-shop.qmimg.cn&#x2F;s23107&#x2F;2020&#x2F;04&#x2F;27&#x2F;0039bf41c9ebd50a2c.jpg&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;title&quot;&gt;&quot;梅&quot;你不行 | 霸气杨梅清爽回归&lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br></pre></td></tr></table></figure>

<h2 id="微信小程序登录开发"><a href="#微信小程序登录开发" class="headerlink" title="微信小程序登录开发"></a>微信小程序登录开发</h2><h3 id="微信小程序登录原理"><a href="#微信小程序登录原理" class="headerlink" title="微信小程序登录原理"></a>微信小程序登录原理</h3><p><img src= "/img/loading.gif" data-lazy-src="https://res.wx.qq.com/wxdoc/dist/assets/img/api-login.2fcc9f35.jpg" alt="img"></p>
<p>步骤</p>
<p><em>第一步：小程序通过uni.login()获取code。</em></p>
<p><em>第二步：小程序通过uni.request()发送code到开发者服务器。</em></p>
<p><em>第三步：开发者服务器接收小程序发送的code，并携带appid、appsecret（这两个需要到微信小程序后台查看）、code发送到微信服务器。</em></p>
<p><em>第四步：微信服务器接收开发者服务器发送的appid、appsecret、code进行校验。校验通过后向开发者服务器发送session_key、openid。</em></p>
<p><em>第五步：开发者服务器自己生成一个key（自定义登录状态）与openid、session_key进行关联，并存到数据库中（mysql、redis、云数据库等）。</em></p>
<p><em>第六步：开发者服务器返回生成key（自定义登录状态）到小程序。</em></p>
<p><em>第七步：小程序存储key（自定义登录状态）到本地。</em></p>
<h3 id="unicloud登录微信小程序"><a href="#unicloud登录微信小程序" class="headerlink" title="unicloud登录微信小程序"></a>unicloud登录微信小程序</h3><p>首先是login.vue 登陆按钮，启动登陆方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">...mapMutations([&#39;Login&#39;]),</span><br><span class="line">        wxLogin(e) &#123;</span><br><span class="line">                const that &#x3D; this;</span><br><span class="line">                let userInfo &#x3D; e.detail.userInfo;</span><br><span class="line">                uni.showLoading(&#123;</span><br><span class="line">                    title: &#39;登录中...&#39;</span><br><span class="line">                &#125;)</span><br><span class="line">                return new Promise((resolve, reject)&#x3D;&gt;&#123;</span><br><span class="line">                    uni.login(&#123;</span><br><span class="line">                        provider:&#39;weixin&#39;,</span><br><span class="line">                        success(login_res) &#123;</span><br><span class="line">                            if (login_res.code) &#123;</span><br><span class="line">                                resolve(login_res.code)</span><br><span class="line">                            &#125; else &#123;</span><br><span class="line">                                reject(new Error(&#39;微信登录失败&#39;))</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;,</span><br><span class="line">                        fail(e) &#123;</span><br><span class="line">                            reject(new Error(&#39;微信登录失败&#39;))</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;).then((code)&#x3D;&gt;&#123;</span><br><span class="line">                    console.log(&quot;code:&quot;, code)</span><br><span class="line">                    return uniCloud.callFunction(&#123;</span><br><span class="line">                        name: &#39;member&#39;,</span><br><span class="line">                        data: &#123;</span><br><span class="line">                            code,</span><br><span class="line">                            userInfo</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;).then((res)&#x3D;&gt;&#123;</span><br><span class="line">                    uni.hideLoading()</span><br><span class="line">                    console.log(res);</span><br><span class="line">                    if (res.result.status !&#x3D;&#x3D; 0) &#123;</span><br><span class="line">                        return Promise.reject(new Error(res.result.msg))</span><br><span class="line">                    &#125;</span><br><span class="line">                    that.Login(res.result.data)</span><br><span class="line">                    uni.showModal(&#123;</span><br><span class="line">                        content: &#39;登录成功&#39;,</span><br><span class="line">                        showCancel: false</span><br><span class="line">                    &#125;)</span><br><span class="line">                    uni.hideLoading()</span><br><span class="line">                    uni.navigateBack()</span><br><span class="line">                </span><br><span class="line">                &#125;).catch((err) &#x3D;&gt; &#123;</span><br><span class="line">                    console.log(err);</span><br><span class="line">                    uni.hideLoading()</span><br><span class="line">                    uni.showModal(&#123;</span><br><span class="line">                    content: &#39;出现错误，请稍后再试.&#39; + err.message,</span><br><span class="line">                    showCancel: false</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">                </span><br><span class="line">           &#125;</span><br></pre></td></tr></table></figure>

<p>然后是unicloud新建云函数login</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">&#39;use strict&#39;;</span><br><span class="line">const crypto &#x3D; require(&#39;crypto&#39;);</span><br><span class="line">const jwt &#x3D; require(&#39;jwt-simple&#39;);</span><br><span class="line">const db &#x3D; uniCloud.database();</span><br><span class="line">const loginConfig &#x3D;&#123;</span><br><span class="line">    appId:&#39;wx62e0151eaf62eff7&#39;,</span><br><span class="line">    appSecret: &#39;c45170b3aa8dbc5cd45ab12c319298f8&#39;</span><br><span class="line">&#125;;</span><br><span class="line">exports.main &#x3D; async (event, context) &#x3D;&gt; &#123;</span><br><span class="line">  &#x2F;&#x2F;event为客户端上传的参数</span><br><span class="line">    let data &#x3D; &#123;</span><br><span class="line">        appid: loginConfig.appId,</span><br><span class="line">        secret: loginConfig.appSecret,</span><br><span class="line">        js_code: event.code,</span><br><span class="line">        grant_type: &#39;authorization_code&#39;</span><br><span class="line">    &#125;;</span><br><span class="line">    &#x2F;&#x2F;向微信服务器提交code并接收openId和session_key</span><br><span class="line">    const res &#x3D; await uniCloud.httpclient.request(&#39;https:&#x2F;&#x2F;api.weixin.qq.com&#x2F;sns&#x2F;jscode2session&#39;, &#123;</span><br><span class="line">      method: &#39;GET&#39;,</span><br><span class="line">      data,</span><br><span class="line">      dataType: &#39;json&#39;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    const success &#x3D; res.status &#x3D;&#x3D;&#x3D; 200 &amp;&amp; res.data &amp;&amp; res.data.openid;</span><br><span class="line">    </span><br><span class="line">    if (!success) &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        status: -1,</span><br><span class="line">        msg: &#39;微信登录失败&#39;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    const openId &#x3D; res.data.openid</span><br><span class="line">    const tonkenExp &#x3D; 7200000;</span><br><span class="line">    &#x2F;&#x2F;当前时间</span><br><span class="line">    let time &#x3D; new Date().toUTCString();</span><br><span class="line">    let tokenSecret &#x3D; crypto.randomBytes(16).toString(&#39;hex&#39;),</span><br><span class="line">    token &#x3D; jwt.encode(openId, tokenSecret);</span><br><span class="line">     </span><br><span class="line">    let userInfo &#x3D; &#123;</span><br><span class="line">        openId : res.data.openid,</span><br><span class="line">        nickName : event.userInfo.nickName,</span><br><span class="line">        avatarUrl : event.userInfo.avatarUrl,</span><br><span class="line">        gender : event.userInfo.gender,</span><br><span class="line">        city : event.userInfo.city,</span><br><span class="line">        balance: &#39;&#39;,</span><br><span class="line">        couponNum: &#39;&#39;,</span><br><span class="line">        currentValue: &#39;&#39;,</span><br><span class="line">        giftBalance: &#39;&#39;,</span><br><span class="line">        level:&#39;&#39;,</span><br><span class="line">        pointNum:&#39;&#39;,</span><br><span class="line">        CreateTime: time,</span><br><span class="line">        lastLoginTime : time</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    let userUpdate &#x3D; &#123;</span><br><span class="line">        openId : res.data.openid,</span><br><span class="line">        nickName : event.userInfo.nickName,</span><br><span class="line">        avatarUrl : event.userInfo.avatarUrl,</span><br><span class="line">        gender : event.userInfo.gender,</span><br><span class="line">        city : event.userInfo.city,</span><br><span class="line">        lastLoginTime : time</span><br><span class="line">    &#125;</span><br><span class="line">    let userResult</span><br><span class="line">    </span><br><span class="line">    const userInDB &#x3D; await db.collection(&#39;users&#39;).where(&#123;</span><br><span class="line">      openId</span><br><span class="line">    &#125;).limit(1).get();</span><br><span class="line">    </span><br><span class="line">    if (userInDB.data &amp;&amp; userInDB.data.length &#x3D;&#x3D;&#x3D; 0) &#123;</span><br><span class="line">      userResult &#x3D; await db.collection(&#39;users&#39;).add(&#123;</span><br><span class="line">        ...userInfo,</span><br><span class="line">        tokenSecret,</span><br><span class="line">        exp:Date.now() + tonkenExp</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      userResult &#x3D; await db.collection(&#39;users&#39;).where(&#123;openId&#125;).update(&#123;</span><br><span class="line">          ...userUpdate,</span><br><span class="line">          tokenSecret,</span><br><span class="line">          exp:Date.now() + tonkenExp</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    const fields &#x3D; &#123;</span><br><span class="line">        openId:1,</span><br><span class="line">        nickName : 1,</span><br><span class="line">        avatarUrl : 1,</span><br><span class="line">        balance: 1,</span><br><span class="line">        couponNum: 1,</span><br><span class="line">        currentValue: 1,</span><br><span class="line">        giftBalance: 1,</span><br><span class="line">        level:1,</span><br><span class="line">        pointNum:1,</span><br><span class="line">        gender:1</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    let ResultOK &#x3D; await db.collection(&#39;users&#39;).where(&#123;openId&#125;).field(fields).get();</span><br><span class="line">    let ResultData &#x3D; ResultOK.data[0];</span><br><span class="line">  &#x2F;&#x2F;返回数据给客户端</span><br><span class="line">    if (userResult.id || userResult.updated &#x3D;&#x3D;&#x3D; 1) &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">          &quot;status&quot;: 0,</span><br><span class="line">          &quot;data&quot;: ResultData,</span><br><span class="line">          &quot;token&quot;: token,</span><br><span class="line">          &quot;msg&quot;: &#39;登录成功&#39;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    </span><br><span class="line">      return &#123;</span><br><span class="line">        &quot;status&quot;: -1,</span><br><span class="line">        &quot;msg&quot;: &#39;微信登录失败&#39;</span><br><span class="line">      &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>首页</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;view class&#x3D;&quot;container&quot;&gt;</span><br><span class="line">        &lt;!-- 首页banner --&gt;</span><br><span class="line">        &lt;view class&#x3D;&quot;banner&quot;&gt;</span><br><span class="line">            &lt;image src&#x3D;&quot;https:&#x2F;&#x2F;img-shop.qmimg.cn&#x2F;s23107&#x2F;2020&#x2F;04&#x2F;26&#x2F;3eb7808bf105262604.jpg&quot; class&#x3D;&quot;bg&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;intro&quot;&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;greet&quot;&gt;您好，&#123;&#123; isLogin ? userInfo.nickName : &#39;游客&#39; &#125;&#125;&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;note&quot;&gt;一杯奶茶，一口软欧包，在奈雪遇见两种美好&lt;&#x2F;view&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">        &lt;&#x2F;view&gt;</span><br><span class="line">        &lt;!-- 首页content --&gt;</span><br><span class="line">        &lt;view class&#x3D;&quot;content&quot;&gt;</span><br><span class="line">            &lt;!-- 点餐入口 --&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;entrance&quot;&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;item&quot; @tap&#x3D;&quot;takein&quot;&gt;</span><br><span class="line">                    &lt;image src&#x3D;&quot;..&#x2F;..&#x2F;static&#x2F;images&#x2F;index&#x2F;zq.png&quot; class&#x3D;&quot;icon&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;title&quot;&gt;自取&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;item&quot; @tap&#x3D;&quot;takeout&quot;&gt;</span><br><span class="line">                    &lt;image src&#x3D;&quot;..&#x2F;..&#x2F;static&#x2F;images&#x2F;index&#x2F;wm.png&quot; class&#x3D;&quot;icon&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;title&quot;&gt;外卖&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">            &lt;!-- 会员积分 --&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;info&quot;&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;integral_section&quot; @tap&#x3D;&quot;integrals&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;top&quot;&gt;</span><br><span class="line">                        &lt;text class&#x3D;&quot;title&quot;&gt;我的积分&lt;&#x2F;text&gt;</span><br><span class="line">                        &lt;text class&#x3D;&quot;value&quot;&gt;&#123;&#123; isLogin ? userInfo.pointNum : 0 &#125;&#125;&lt;&#x2F;text&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;bottom&quot;&gt;</span><br><span class="line">                        进入积分商城兑换奈雪券及周边好礼</span><br><span class="line">                        &lt;view class&#x3D;&quot;iconfont iconarrow-right&quot;&gt;&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;qrcode_section&quot; @tap&#x3D;&quot;memberCode&quot;&gt;</span><br><span class="line">                    &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;index&#x2F;qrcode.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                    &lt;text&gt;会员码&lt;&#x2F;text&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">            &lt;!-- 奈雪茶商城 --&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;navigators&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;left&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;grid flex-column just-content-center&quot;&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;d-flex align-items-center&quot;&gt;</span><br><span class="line">                                &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;index&#x2F;csc.png&quot; class&#x3D;&quot;mark-img&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                                &lt;view class&#x3D;&quot;font-size-sm text-color-base&quot;&gt;奈雪的茶商城&lt;&#x2F;view&gt;</span><br><span class="line">                            &lt;&#x2F;view&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;text-color-assist&quot; style&#x3D;&quot;margin-left: 40rpx; font-size: 20rpx;&quot;&gt;优质茶礼盒，网红零食&lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;grid justify-content-end align-items-end&quot;&gt;</span><br><span class="line">                            &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;index&#x2F;yzclh.png&quot; class&#x3D;&quot;yzclh-img&quot; mode&#x3D;&quot;heightFix&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;right&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;tea-activity&quot; @tap&#x3D;&quot;invite&quot;&gt;</span><br><span class="line">                            &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;index&#x2F;mcsb.png&quot; class&#x3D;&quot;mark-img&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                            &lt;view&gt;买茶送包&lt;&#x2F;view&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;right-img&quot;&gt;</span><br><span class="line">                                &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;index&#x2F;mcsb_bg.png&quot; mode&#x3D;&quot;widthFix&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                            &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;member-gifts&quot; @tap&#x3D;&quot;packages&quot;&gt;</span><br><span class="line">                            &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;index&#x2F;hyjb.png&quot; class&#x3D;&quot;mark-img&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                            &lt;view&gt;会员劵包&lt;&#x2F;view&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;right-img&quot;&gt;</span><br><span class="line">                                &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;index&#x2F;hyjb_bg.png&quot; mode&#x3D;&quot;widthFix&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                            &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;member-news&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;header&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;title&quot;&gt;会员新鲜事&lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;iconfont iconRightbutton&quot;&gt;&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;list&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;item&quot;&gt;</span><br><span class="line">                            &lt;image src&#x3D;&quot;https:&#x2F;&#x2F;img-shop.qmimg.cn&#x2F;s23107&#x2F;2020&#x2F;04&#x2F;27&#x2F;0039bf41c9ebd50a2c.jpg&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;title&quot;&gt;&quot;梅&quot;你不行 | 霸气杨梅清爽回归&lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">        &lt;&#x2F;view&gt;</span><br><span class="line">    &lt;&#x2F;view&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    import &#123;mapState&#125; from &#39;vuex&#39;</span><br><span class="line">    export default &#123;</span><br><span class="line">        data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                title: &#39;Hello&#39;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        onLoad() &#123;</span><br><span class="line"></span><br><span class="line">        &#125;,</span><br><span class="line">        computed: &#123;</span><br><span class="line">            ...mapState([&#39;isLogin&#39;,&#39;orderType&#39;,&#39;userInfo&#39;,&#39;chooseStore&#39;])</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            &#x2F;&#x2F; 点餐</span><br><span class="line">            takein() &#123;</span><br><span class="line">                if(!this.chooseStore) &#123;</span><br><span class="line">                    uni.navigateTo(&#123;</span><br><span class="line">                        url:&#39;..&#x2F;stores&#x2F;stores&#39;</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">                &#123;</span><br><span class="line">                    this.$store.commit(&#39;SET_ORDERTYPE&#39;,&#39;takein&#39;)</span><br><span class="line">                uni.switchTab(&#123;</span><br><span class="line">                    url:&#39;..&#x2F;menu&#x2F;menu&#39;</span><br><span class="line">                &#125;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            </span><br><span class="line">            takeout() &#123;</span><br><span class="line">                if(!this.isLogin) &#123;</span><br><span class="line">                    uni.navigateTo(&#123;url: &#39;&#x2F;pages&#x2F;login&#x2F;login&#39;&#125;)</span><br><span class="line">                    </span><br><span class="line">                &#125;</span><br><span class="line">                uni.navigateTo(&#123;</span><br><span class="line">                    url: &quot;&#x2F;pages&#x2F;address&#x2F;address?is_choose&#x3D;true&quot;    </span><br><span class="line">                &#125;)</span><br><span class="line">                </span><br><span class="line">            &#125;,</span><br><span class="line">            </span><br><span class="line">            memberCode() &#123;</span><br><span class="line">                uni.showLoading(&#123;</span><br><span class="line">                    title: &#39;加载中...&#39;</span><br><span class="line">                &#125;);</span><br><span class="line">                uniCloud.callFunction(&#123;</span><br><span class="line">                    name: &#39;validateToken&#39;,</span><br><span class="line">                    data: &#123;</span><br><span class="line">                        token: uni.getStorageSync(&#39;token&#39;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;).then((res) &#x3D;&gt; &#123;</span><br><span class="line">                    console.log(res);</span><br><span class="line">                    uni.hideLoading()</span><br><span class="line">                    uni.showModal(&#123;</span><br><span class="line">                        content: res.result.msg,</span><br><span class="line">                        showCancel: false</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;).catch((err) &#x3D;&gt; &#123;</span><br><span class="line">                    uni.hideLoading()</span><br><span class="line">                    uni.showModal(&#123;</span><br><span class="line">                        content: &#39;请求云函数发生错误，&#39; + err.message,</span><br><span class="line">                        showCancel: false</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang&#x3D;&quot;scss&quot;&gt;</span><br><span class="line">    .banner&#123;</span><br><span class="line">        position: relative;</span><br><span class="line">        height: 600rpx;</span><br><span class="line">        width: 100%;</span><br><span class="line">        &#x2F;&#x2F;背景图片</span><br><span class="line">        .bg&#123;</span><br><span class="line">            height: 600rpx;</span><br><span class="line">            width: 100%;</span><br><span class="line">        &#125;</span><br><span class="line">        .intro &#123;</span><br><span class="line">            position: absolute;</span><br><span class="line">            display: flex;</span><br><span class="line">            flex-direction: column;</span><br><span class="line">            color: #FFFFFF;</span><br><span class="line">            top: calc(50rpx + var(--status-bar-height));</span><br><span class="line">            left: 40rpx;</span><br><span class="line">            .greet &#123;</span><br><span class="line">                font-size: $font-size-lg;</span><br><span class="line">                margin-bottom: 10rpx;</span><br><span class="line">            &#125;</span><br><span class="line">            .note &#123;</span><br><span class="line">                font-size: $font-size-sm;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    .content &#123;</span><br><span class="line">        padding: 0 30rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    .entrance &#123;</span><br><span class="line">        position: relative;</span><br><span class="line">        margin-top: -80rpx;</span><br><span class="line">        margin-bottom: 30rpx;</span><br><span class="line">        border-radius: 10rpx;</span><br><span class="line">        background-color: #FFFFFF;</span><br><span class="line">        box-shadow: $box-shadow;</span><br><span class="line">        display: flex;</span><br><span class="line">        align-items: center;</span><br><span class="line">        justify-content: center;</span><br><span class="line">        padding: 30rpx 0;</span><br><span class="line">        </span><br><span class="line">        .item &#123;</span><br><span class="line">            position: relative;</span><br><span class="line">            display: flex;</span><br><span class="line">            flex: 1;</span><br><span class="line">            flex-direction: column;</span><br><span class="line">            align-items: center;</span><br><span class="line">            justify-content: center;</span><br><span class="line">            </span><br><span class="line">            &amp;:nth-child(1):after &#123;</span><br><span class="line">                        content: &#39;&#39;;</span><br><span class="line">                        position: absolute;</span><br><span class="line">                        width: 1rpx;</span><br><span class="line">                        background-color: $text-color-assist;</span><br><span class="line">                        right: 0;</span><br><span class="line">                        height: 100%;</span><br><span class="line">                        transform: scaleX(0.5) scaleY(0.8);</span><br><span class="line">                    &#125;</span><br><span class="line">                    </span><br><span class="line">                    .icon &#123;</span><br><span class="line">                        width: 84rpx;</span><br><span class="line">                        height: 84rpx;</span><br><span class="line">                        margin: 20rpx;</span><br><span class="line">                    &#125;</span><br><span class="line">                    </span><br><span class="line">                    .title &#123;</span><br><span class="line">                        font-size: 30rpx;</span><br><span class="line">                        font-weight: 600;</span><br><span class="line">                        color: $text-color-base;</span><br><span class="line">                    &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F; 用户积分</span><br><span class="line">    .info &#123;</span><br><span class="line">        position: relative;</span><br><span class="line">        margin-bottom: 30rpx;</span><br><span class="line">        border-radius: 10rpx;</span><br><span class="line">        background-color: #ffffff;</span><br><span class="line">        box-shadow: $box-shadow;</span><br><span class="line">        padding: 30rpx;</span><br><span class="line">        display: flex;</span><br><span class="line">        align-items: center;</span><br><span class="line">        justify-content: center;</span><br><span class="line">        </span><br><span class="line">        .integral_section &#123;</span><br><span class="line">            flex: 1;</span><br><span class="line">            display: flex;</span><br><span class="line">            flex-direction: column;</span><br><span class="line">            justify-content: center;</span><br><span class="line">            </span><br><span class="line">            .top &#123;</span><br><span class="line">                display: flex;</span><br><span class="line">                align-items: center;</span><br><span class="line">                </span><br><span class="line">                .title &#123;</span><br><span class="line">                    color: $text-color-base;</span><br><span class="line">                    font-size: $font-size-base;</span><br><span class="line">                    margin-right: 10rpx;</span><br><span class="line">                &#125;</span><br><span class="line">                .value &#123;</span><br><span class="line">                    font-size: 44rpx;</span><br><span class="line">                    font-weight: bold;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .bottom &#123;</span><br><span class="line">                font-size: $font-size-sm;</span><br><span class="line">                color: $text-color-assist;</span><br><span class="line">                display: flex;</span><br><span class="line">                align-items: center;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .qrcode_section &#123;</span><br><span class="line">            color: $color-primary;</span><br><span class="line">            display: flex;</span><br><span class="line">            flex-direction: column;</span><br><span class="line">            align-items: center;</span><br><span class="line">            justify-content: center;</span><br><span class="line">            font-size: $font-size-sm;</span><br><span class="line">            </span><br><span class="line">            image &#123;</span><br><span class="line">                width: 40rpx;</span><br><span class="line">                height: 40rpx;</span><br><span class="line">                margin-bottom: 10rpx;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;&#x2F;奈雪商城茶包</span><br><span class="line">    .navigators &#123;</span><br><span class="line">        width: 100%;</span><br><span class="line">        margin-bottom: 20rpx;    </span><br><span class="line">        border-radius: 10rpx;</span><br><span class="line">        background-color: #ffffff;</span><br><span class="line">        box-shadow: $box-shadow;</span><br><span class="line">        padding: 20rpx;</span><br><span class="line">        display: flex;</span><br><span class="line">        align-items: stretch;</span><br><span class="line">        </span><br><span class="line">        .left &#123;</span><br><span class="line">            width: 340rpx;</span><br><span class="line">            margin-right: 20rpx;</span><br><span class="line">            display: flex;</span><br><span class="line">            padding: 0 20rpx;</span><br><span class="line">            flex-direction: column;</span><br><span class="line">            font-size: $font-size-sm;</span><br><span class="line">            color: $text-color-base;</span><br><span class="line">            background-color: #F2F2E6;</span><br><span class="line">            </span><br><span class="line">            .grid &#123;</span><br><span class="line">                height: 50%;</span><br><span class="line">                display: flex;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .right &#123;</span><br><span class="line">            width: 290rpx;</span><br><span class="line">            display: flex;</span><br><span class="line">            flex-direction: column;</span><br><span class="line">            </span><br><span class="line">            .tea-activity, .member-gifts &#123;</span><br><span class="line">                width: 100%;</span><br><span class="line">                display: flex;</span><br><span class="line">                padding: 20rpx;</span><br><span class="line">                font-size: $font-size-sm;</span><br><span class="line">                color: $text-color-base;</span><br><span class="line">                align-items: center;</span><br><span class="line">                position: relative;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .tea-activity &#123;</span><br><span class="line">                background-color: #FDF3F2;</span><br><span class="line">                margin-bottom: 20rpx;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .member-gifts &#123;</span><br><span class="line">                background-color: #FCF6D4;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .right-img &#123;</span><br><span class="line">                flex: 1;</span><br><span class="line">                position: relative;</span><br><span class="line">                margin-left: 20rpx;</span><br><span class="line">                margin-right: -20rpx;</span><br><span class="line">                margin-bottom: -20rpx;</span><br><span class="line">                display: flex;</span><br><span class="line">                align-items: flex-end;</span><br><span class="line">                </span><br><span class="line">                image &#123;</span><br><span class="line">                    width: 100%;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .mark-img &#123;</span><br><span class="line">            width: 30rpx;</span><br><span class="line">            height: 30rpx;</span><br><span class="line">            margin-right: 10rpx;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .yzclh-img &#123;</span><br><span class="line">            height: 122.96rpx;</span><br><span class="line">            width: 214.86rpx;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    .member-news &#123;</span><br><span class="line">        width: 100%;</span><br><span class="line">        margin-bottom: 30rpx;</span><br><span class="line">        .header &#123;</span><br><span class="line">            display: flex;</span><br><span class="line">            align-items: center;</span><br><span class="line">            justify-content: space-between;</span><br><span class="line">            padding: 20rpx 0;</span><br><span class="line">            </span><br><span class="line">            .title &#123;</span><br><span class="line">                font-size: $font-size-lg;</span><br><span class="line">                font-weight: bold;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .iconfont &#123;</span><br><span class="line">                font-size: 52rpx;</span><br><span class="line">                color: $text-color-assist;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .list &#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">            display: flex;</span><br><span class="line">            flex-direction: column;</span><br><span class="line">            </span><br><span class="line">            .item &#123;</span><br><span class="line">                width: 100%;</span><br><span class="line">                height: 240rpx;</span><br><span class="line">                position: relative;</span><br><span class="line">                </span><br><span class="line">                image &#123;</span><br><span class="line">                    width: 100%;</span><br><span class="line">                    height: 100%;</span><br><span class="line">                    border-radius: 8rpx;</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                .title &#123;</span><br><span class="line">                    position: relative;</span><br><span class="line">                    font-size: 32rpx;</span><br><span class="line">                    font-weight: 500;</span><br><span class="line">                    width: 100%;</span><br><span class="line">                    top: -70rpx;</span><br><span class="line">                    left: 16rpx;</span><br><span class="line">                    color: #ffffff;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="登录页面login开发"><a href="#登录页面login开发" class="headerlink" title="登录页面login开发"></a>登录页面login开发</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;view class&#x3D;&quot;container&quot;&gt;</span><br><span class="line">        &lt;view class&#x3D;&quot;intro&quot;&gt;</span><br><span class="line">            &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;logo.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;tips&quot;&gt;</span><br><span class="line">                一杯好茶，一口软欧包</span><br><span class="line">                &lt;br&gt;</span><br><span class="line">                在奈雪遇见两种美好</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">        &lt;&#x2F;view&gt;</span><br><span class="line">        &lt;view class&#x3D;&quot;bottom&quot;&gt;</span><br><span class="line">            &lt;!-- #ifdef MP-WEIXIN --&gt;</span><br><span class="line">                &lt;button type&#x3D;&quot;primary&quot; size&#x3D;&quot;default&quot; class&#x3D;&quot;login-btn&quot; open-type&#x3D;&quot;getUserInfo&quot; lang&#x3D;&quot;zh_CN&quot; @getuserinfo&#x3D;&quot;wxLogin&quot;&gt;</span><br><span class="line">                    &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;wechat.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                    微信一键登录</span><br><span class="line">                &lt;&#x2F;button&gt;</span><br><span class="line">            &lt;!-- #endif --&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;d-flex flex-column justify-content-evenly align-items-center text-center&quot; style&#x3D;&quot;height: 30vh;&quot;&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;w-100 font-size-base text-color-assist&quot;&gt;新用户登录即加入会员，享会员权益&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;w-100 row d-flex just-content-around align-items-center font-size-sm text-color-assist&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;grid&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;rhyl.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                        &lt;view&gt;入会有礼&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;grid&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;jfdh.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                        &lt;view&gt;积分兑换&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;grid&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;sjtq.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                        &lt;view&gt;升级特权&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;grid&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;srtq.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                        &lt;view&gt;生日特权&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;grid&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;nxbz.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                        &lt;view&gt;奈雪宝藏&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;font-size-base text-color-primary&quot;&gt;会员权益说明&lt;&#x2F;view&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">        &lt;&#x2F;view&gt;</span><br><span class="line">    &lt;&#x2F;view&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;style lang&#x3D;&quot;scss&quot; scoped&gt;</span><br><span class="line">    .intro &#123;</span><br><span class="line">        width: 100%;</span><br><span class="line">        height: 60vh;</span><br><span class="line">        display: flex;</span><br><span class="line">        flex-direction: column;</span><br><span class="line">        align-items: center;</span><br><span class="line">        justify-content: space-evenly;</span><br><span class="line">        font-size: $font-size-base;</span><br><span class="line">        color: $text-color-assist;</span><br><span class="line">        </span><br><span class="line">        image &#123;</span><br><span class="line">            width: 165rpx;</span><br><span class="line">            height: 165rpx;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .tips &#123;</span><br><span class="line">            line-height: 72rpx;</span><br><span class="line">            text-align: center;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    .bottom &#123;</span><br><span class="line">        height: 40vh;</span><br><span class="line">        display: flex;</span><br><span class="line">        flex-direction: column;</span><br><span class="line">        justify-content: space-between;</span><br><span class="line">        padding: 0 40rpx;</span><br><span class="line">        </span><br><span class="line">        .login-btn &#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">            border-radius: 50rem !important;</span><br><span class="line">            display: flex;</span><br><span class="line">            align-items: center;</span><br><span class="line">            justify-content: center;</span><br><span class="line">            padding: 10rpx 0;</span><br><span class="line">            </span><br><span class="line">            image &#123;</span><br><span class="line">                width: 36rpx;</span><br><span class="line">                height: 30rpx;</span><br><span class="line">                margin-right: 10rpx;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .row &#123;</span><br><span class="line">            .grid &#123;</span><br><span class="line">                width: 20%;</span><br><span class="line">                image &#123;</span><br><span class="line">                    width: 60rpx;</span><br><span class="line">                    height: 60rpx;</span><br><span class="line">                    margin-bottom: 10rpx;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="登录页面login接口开发js和unicloud后端事件"><a href="#登录页面login接口开发js和unicloud后端事件" class="headerlink" title="登录页面login接口开发js和unicloud后端事件"></a>登录页面login接口开发js和unicloud后端事件</h3><h3 id="-3"><a href="#-3" class="headerlink" title></a></h3><p><strong>uni-app端</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">import &#123;mapState, mapMutations&#125; from &#39;vuex&#39;</span><br><span class="line">    </span><br><span class="line">    export default &#123;</span><br><span class="line">        data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        methods: &#123;</span><br><span class="line">            ...mapMutations([&#39;Login&#39;]),</span><br><span class="line">            wxLogin(e) &#123;</span><br><span class="line">                    const that &#x3D; this;</span><br><span class="line">                    let userInfo &#x3D; e.detail.userInfo;</span><br><span class="line">                    uni.showLoading(&#123;</span><br><span class="line">                        title: &#39;登录中...&#39;</span><br><span class="line">                    &#125;)</span><br><span class="line">                    return new Promise((resolve, reject)&#x3D;&gt;&#123;</span><br><span class="line">                        uni.login(&#123;</span><br><span class="line">                            provider:&#39;weixin&#39;,</span><br><span class="line">                            success(login_res) &#123;</span><br><span class="line">                                if (login_res.code) &#123;</span><br><span class="line">                                    resolve(login_res.code)</span><br><span class="line">                                &#125; else &#123;</span><br><span class="line">                                    reject(new Error(&#39;微信登录失败&#39;))</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;,</span><br><span class="line">                            fail(e) &#123;</span><br><span class="line">                                reject(new Error(&#39;微信登录失败&#39;))</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;).then((code)&#x3D;&gt;&#123;</span><br><span class="line">                        console.log(&quot;code:&quot;, code)</span><br><span class="line">                        return uniCloud.callFunction(&#123;</span><br><span class="line">                            name: &#39;login&#39;,</span><br><span class="line">                            data: &#123;</span><br><span class="line">                                code,</span><br><span class="line">                                userInfo</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;).then((res)&#x3D;&gt;&#123;</span><br><span class="line">                        uni.hideLoading()</span><br><span class="line">                        console.log(res);</span><br><span class="line">                        if (res.result.status !&#x3D;&#x3D; 0) &#123;</span><br><span class="line">                            return Promise.reject(new Error(res.result.msg))</span><br><span class="line">                        &#125;</span><br><span class="line">                        console.log(res.result.data)</span><br><span class="line">                        that.Login(res.result.data)</span><br><span class="line">                        uni.setStorage(&#123;</span><br><span class="line">                            key:&#39;token&#39;,</span><br><span class="line">                            data:res.result.token</span><br><span class="line">                        &#125;)</span><br><span class="line">                        uni.showModal(&#123;</span><br><span class="line">                            content: &#39;登录成功&#39;,</span><br><span class="line">                            showCancel: false</span><br><span class="line">                        &#125;)</span><br><span class="line">                        uni.hideLoading()</span><br><span class="line">                        uni.navigateBack()</span><br><span class="line">                    </span><br><span class="line">                    &#125;).catch((err) &#x3D;&gt; &#123;</span><br><span class="line">                        console.log(err);</span><br><span class="line">                        uni.hideLoading()</span><br><span class="line">                        uni.showModal(&#123;</span><br><span class="line">                        content: &#39;出现错误，请稍后再试.&#39; + err.message,</span><br><span class="line">                        showCancel: false</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;)</span><br><span class="line">                    </span><br><span class="line">               &#125;</span><br><span class="line">        </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>vuex<strong>改变登录状态</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;登录</span><br><span class="line">        Login(state,res) &#123;</span><br><span class="line">            state.isLogin &#x3D; true</span><br><span class="line">            state.userInfo &#x3D; res</span><br><span class="line">            uni.setStorage(&#123;</span><br><span class="line">                    key: &#39;userinfo&#39;,</span><br><span class="line">                    data: res</span><br><span class="line">                  &#125;)</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<h3 id="uniCloud后端"><a href="#uniCloud后端" class="headerlink" title="uniCloud后端"></a>uniCloud<strong>后端</strong></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">&#39;use strict&#39;;</span><br><span class="line">const crypto &#x3D; require(&#39;crypto&#39;);</span><br><span class="line">const jwt &#x3D; require(&#39;jwt-simple&#39;);</span><br><span class="line">const db &#x3D; uniCloud.database();</span><br><span class="line">const loginConfig &#x3D;&#123;</span><br><span class="line">    appId:&#39;wx62e0151eaf62eff7&#39;,</span><br><span class="line">    appSecret: &#39;&#39;</span><br><span class="line">&#125;;</span><br><span class="line">exports.main &#x3D; async (event, context) &#x3D;&gt; &#123;</span><br><span class="line">  &#x2F;&#x2F;event为客户端上传的参数</span><br><span class="line">    let data &#x3D; &#123;</span><br><span class="line">        appid: loginConfig.appId,</span><br><span class="line">        secret: loginConfig.appSecret,</span><br><span class="line">        js_code: event.code,</span><br><span class="line">        grant_type: &#39;authorization_code&#39;</span><br><span class="line">    &#125;;</span><br><span class="line">    &#x2F;&#x2F;向微信服务器提交code并接收openId和session_key</span><br><span class="line">    const res &#x3D; await uniCloud.httpclient.request(&#39;https:&#x2F;&#x2F;api.weixin.qq.com&#x2F;sns&#x2F;jscode2session&#39;, &#123;</span><br><span class="line">      method: &#39;GET&#39;,</span><br><span class="line">      data,</span><br><span class="line">      dataType: &#39;json&#39;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    const success &#x3D; res.status &#x3D;&#x3D;&#x3D; 200 &amp;&amp; res.data &amp;&amp; res.data.openid;</span><br><span class="line">    </span><br><span class="line">    if (!success) &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        status: -1,</span><br><span class="line">        msg: &#39;微信登录失败&#39;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    const openId &#x3D; res.data.openid</span><br><span class="line">    const tonkenExp &#x3D; 7200000;</span><br><span class="line">    &#x2F;&#x2F;当前时间</span><br><span class="line">    let time &#x3D; new Date().toUTCString();</span><br><span class="line">    let tokenSecret &#x3D; crypto.randomBytes(16).toString(&#39;hex&#39;),</span><br><span class="line">    token &#x3D; jwt.encode(openId, tokenSecret);</span><br><span class="line">     </span><br><span class="line">    let userInfo &#x3D; &#123;</span><br><span class="line">        openId : res.data.openid,</span><br><span class="line">        nickName : event.userInfo.nickName,</span><br><span class="line">        avatarUrl : event.userInfo.avatarUrl,</span><br><span class="line">        gender : event.userInfo.gender,</span><br><span class="line">        city : event.userInfo.city,</span><br><span class="line">        balance: &#39;&#39;,</span><br><span class="line">        couponNum: &#39;&#39;,</span><br><span class="line">        currentValue: &#39;&#39;,</span><br><span class="line">        giftBalance: &#39;&#39;,</span><br><span class="line">        level:&#39;&#39;,</span><br><span class="line">        pointNum:&#39;&#39;,</span><br><span class="line">        CreateTime: time,</span><br><span class="line">        lastLoginTime : time</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    let userUpdate &#x3D; &#123;</span><br><span class="line">        openId : res.data.openid,</span><br><span class="line">        nickName : event.userInfo.nickName,</span><br><span class="line">        avatarUrl : event.userInfo.avatarUrl,</span><br><span class="line">        gender : event.userInfo.gender,</span><br><span class="line">        city : event.userInfo.city,</span><br><span class="line">        lastLoginTime : time</span><br><span class="line">    &#125;</span><br><span class="line">    let userResult</span><br><span class="line">    </span><br><span class="line">    const userInDB &#x3D; await db.collection(&#39;users&#39;).where(&#123;</span><br><span class="line">      openId</span><br><span class="line">    &#125;).limit(1).get();</span><br><span class="line">    </span><br><span class="line">    if (userInDB.data &amp;&amp; userInDB.data.length &#x3D;&#x3D;&#x3D; 0) &#123;</span><br><span class="line">      userResult &#x3D; await db.collection(&#39;users&#39;).add(&#123;</span><br><span class="line">        ...userInfo,</span><br><span class="line">        tokenSecret,</span><br><span class="line">        exp:Date.now() + tonkenExp</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      userResult &#x3D; await db.collection(&#39;users&#39;).where(&#123;openId&#125;).update(&#123;</span><br><span class="line">          ...userUpdate,</span><br><span class="line">          tokenSecret,</span><br><span class="line">          exp:Date.now() + tonkenExp</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    const fields &#x3D; &#123;</span><br><span class="line">        </span><br><span class="line">        nickName : 1,</span><br><span class="line">        avatarUrl : 1,</span><br><span class="line">        balance: 1,</span><br><span class="line">        couponNum: 1,</span><br><span class="line">        currentValue: 1,</span><br><span class="line">        giftBalance: 1,</span><br><span class="line">        level:1,</span><br><span class="line">        pointNum:1,</span><br><span class="line">        gender:1</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    let ResultOK &#x3D; await db.collection(&#39;users&#39;).where(&#123;openId&#125;).field(fields).get();</span><br><span class="line">    let ResultData &#x3D; ResultOK.data[0];</span><br><span class="line">  &#x2F;&#x2F;返回数据给客户端</span><br><span class="line">    if (userResult.id || userResult.updated &#x3D;&#x3D;&#x3D; 1) &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">          &quot;status&quot;: 0,</span><br><span class="line">          &quot;data&quot;: ResultData,</span><br><span class="line">          &quot;token&quot;: token,</span><br><span class="line">          &quot;msg&quot;: &#39;登录成功&#39;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    </span><br><span class="line">      return &#123;</span><br><span class="line">        &quot;status&quot;: -1,</span><br><span class="line">        &quot;msg&quot;: &#39;微信登录失败&#39;</span><br><span class="line">      &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="个人中心页面开发"><a href="#个人中心页面开发" class="headerlink" title="个人中心页面开发"></a>个人中心页面开发</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class&#x3D;&quot;container&quot;&gt;</span><br><span class="line">        &lt;view class&#x3D;&quot;position-relative&quot;&gt;</span><br><span class="line">            &lt;image src&#x3D;&quot;https:&#x2F;&#x2F;img-shop.qmimg.cn&#x2F;s16&#x2F;images&#x2F;2020&#x2F;01&#x2F;20&#x2F;9a82219bedcae5c2.jpeg&quot; class&#x3D;&quot;bg&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">            &lt;button type&#x3D;&quot;default&quot; size&#x3D;&quot;mini&quot; class&#x3D;&quot;hym-btn&quot; @tap&#x3D;&quot;memberCode&quot;&gt;</span><br><span class="line">                &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;hym.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                &lt;text&gt;会员码&lt;&#x2F;text&gt;</span><br><span class="line">            &lt;&#x2F;button&gt;</span><br><span class="line">        &lt;&#x2F;view&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;view style&#x3D;&quot;padding: 0 30rpx;&quot;&gt;</span><br><span class="line">            &lt;!-- user box begin --&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;user-box&quot;&gt;</span><br><span class="line">                </span><br><span class="line">                &lt;view class&#x3D;&quot;user-info&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;avatar&quot;&gt;</span><br><span class="line">                        &lt;image :src&#x3D;&quot;isLogin ? userInfo.avatarUrl : &#39;&#x2F;static&#x2F;images&#x2F;mine&#x2F;default.png&#39;&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;badge&quot; v-if&#x3D;&quot;isLogin&quot;&gt;</span><br><span class="line">                            &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;level.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                            &lt;view&gt;&#123;&#123; userInfo.level &#125;&#125;&lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;d-flex flex-column flex-fill overflow-hidden&quot; style&#x3D;&quot;margin-top: 20rpx;&quot;&gt;</span><br><span class="line">                        &lt;view v-if&#x3D;&quot;isLogin&quot; class&#x3D;&quot;font-size-lg font-weight-bold d-flex justify-content-start align-items-center&quot;</span><br><span class="line">                            @tap&#x3D;&quot;userinfo&quot;&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;text-truncate&quot;&gt;&#123;&#123; userInfo.nickName &#125;&#125;&lt;&#x2F;view&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;iconfont iconarrow-right line-height-100&quot;&gt;&lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view v-else class&#x3D;&quot;font-size-lg font-weight-bold&quot; @tap&#x3D;&quot;login&quot;&gt;请点击授权登录&lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;font-size-sm text-color-assist&quot;&gt;</span><br><span class="line">                            当前成长值&#123;&#123; isLogin ? userInfo.currentValue : 0 &#125;&#125;&#x2F;&#123;&#123; isLogin ? userInfo.currentValue + userInfo.needValue : 0 &#125;&#125;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;w-100&quot;&gt;</span><br><span class="line">                             &lt;progress percent&#x3D;&quot;0&quot; activeColor&#x3D;&quot;#ADB838&quot; height&#x3D;&quot;8rpx&quot; :percent&#x3D;&quot;growthValue&quot; border-radius&#x3D;&quot;8rpx&quot;&#x2F;&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;level-benefit d-flex flex-shrink-0 align-items-center justify-content-end text-color-white bg-warning font-size-sm&quot;&gt;</span><br><span class="line">                        &lt;view&gt;会员权益&lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;iconfont iconarrow-right line-height-100&quot;&gt;&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;!-- user grid begin --&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;w-100 d-flex align-items-center just-content-center&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;user-grid&quot; @tap&#x3D;&quot;coupons&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;value font-size-extra-lg font-weight-bold text-color-base&quot;&gt;</span><br><span class="line">                            &#123;&#123;  isLogin ? userInfo.couponNum : &#39;***&#39; &#125;&#125;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;font-size-sm text-color-assist&quot;&gt;奈雪券&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;user-grid&quot; @tap&#x3D;&quot;integrals&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;value font-size-extra-lg font-weight-bold text-color-base&quot;&gt;</span><br><span class="line">                            &#123;&#123;  isLogin ? userInfo.pointNum : &#39;***&#39; &#125;&#125;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;font-size-sm text-color-assist&quot;&gt;积分商城&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;user-grid&quot; @tap&#x3D;&quot;balance&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;value font-size-extra-lg font-weight-bold text-color-base&quot;&gt;</span><br><span class="line">                            &#123;&#123;  isLogin ? userInfo.balance : &#39;***&#39; &#125;&#125;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;font-size-sm text-color-assist&quot;&gt;余额&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;user-grid&quot; @tap&#x3D;&quot;giftCards&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;value font-size-extra-lg font-weight-bold text-color-base&quot;&gt;</span><br><span class="line">                            &#123;&#123;  isLogin ? userInfo.giftBalance : &#39;***&#39; &#125;&#125;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;font-size-sm text-color-assist&quot;&gt;礼品卡&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;!-- user grid end --&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">            &lt;!-- user box end --&gt;</span><br><span class="line">            &lt;!-- level benefit box begin --&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;level-benefit-box&quot; v-if&#x3D;&quot;!isLogin&quot;&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;d-flex align-items-center justify-content-between font-size-base&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;text-color-base&quot;&gt;新用户加入会员，享会员权益&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;text-color-primary&quot; @tap&#x3D;&quot;login&quot;&gt;立即加入&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;row&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;grid&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;rhyl.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                        &lt;view&gt;入会有礼&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;grid&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;jfdh.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                        &lt;view&gt;积分兑换&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;grid&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;sjtq.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                        &lt;view&gt;升级特权&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;grid&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;srtq.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                        &lt;view&gt;生日特权&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;grid&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;nxbz.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                        &lt;view&gt;奈雪宝藏&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">            &lt;!-- level benefit box end --&gt;</span><br><span class="line">            &lt;!-- banner begin --&gt;</span><br><span class="line">            &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;banner.png&quot; class&#x3D;&quot;banner&quot; mode&#x3D;&quot;widthFix&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">            &lt;!-- bennaer end --&gt;</span><br><span class="line">        &lt;&#x2F;view&gt;</span><br><span class="line">        &lt;!-- service box begin --&gt;</span><br><span class="line">        &lt;view class&#x3D;&quot;service-box&quot;&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;font-size-lg text-color-base font-weight-bold&quot; style&#x3D;&quot;margin-bottom: 20rpx;&quot;&gt;我的服务&lt;&#x2F;view&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;row&quot;&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;grid&quot; @tap&#x3D;&quot;attendance&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;image&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;jfqd.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view&gt;积分签到&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;grid&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;image&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;stxy.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view&gt;送她心愿&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;image :src&#x3D;&quot;newIcon&quot; class&#x3D;&quot;new-badage&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;grid&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;image&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;nxsc.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view&gt;奈雪商城&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;grid&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;image&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;lxkf.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view&gt;联系客服&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;grid&quot; @tap&#x3D;&quot;orders&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;image&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;wddd.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view&gt;我的订单&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;grid&quot; @tap&#x3D;&quot;userinfo&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;image&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;wdzl.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view&gt;我的资料&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;grid&quot; @tap&#x3D;&quot;addresses&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;image&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;shdz.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view&gt;收货地址&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;grid&quot; @tap&#x3D;&quot;services&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;image&quot;&gt;</span><br><span class="line">                        &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;mine&#x2F;gdfw.png&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view&gt;更多服务&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">        &lt;&#x2F;view&gt;</span><br><span class="line">        &lt;!-- service box end --&gt;</span><br><span class="line">        &lt;!-- tips begin --&gt;</span><br><span class="line">        &lt;view class&#x3D;&quot;d-flex just-content-center align-items-center text-color-assist&quot; style&#x3D;&quot;padding: 30rpx 0; font-size: 22rpx;&quot;&gt;</span><br><span class="line">            会员卡适用于奈雪的茶和奈雪酒屋指定范围</span><br><span class="line">        &lt;&#x2F;view&gt;</span><br><span class="line">        &lt;!-- tisps end --&gt;</span><br><span class="line">    &lt;&#x2F;view&gt;</span><br></pre></td></tr></table></figure>

<h4 id="个人中心CSS样式"><a href="#个人中心CSS样式" class="headerlink" title="个人中心CSS样式"></a><strong>个人中心CSS样式</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br></pre></td><td class="code"><pre><span class="line">page &#123;</span><br><span class="line">    height: auto;</span><br><span class="line">    min-height: 100%;</span><br><span class="line">&#125;    </span><br><span class="line"></span><br><span class="line">.bg &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    height: calc(410 &#x2F; 594 * 750rpx);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.hym-btn &#123;</span><br><span class="line">    position: absolute;</span><br><span class="line">    top: 40rpx;</span><br><span class="line">    right: 40rpx;</span><br><span class="line">    color: $color-primary;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    border-radius: 50rem;</span><br><span class="line">    font-size: $font-size-sm;</span><br><span class="line">    box-shadow: 0 0 20rpx rgba(66,66,66,0.1);</span><br><span class="line">    &amp;::after &#123;</span><br><span class="line">        border: 0;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    image &#123;</span><br><span class="line">        width: 30rpx;</span><br><span class="line">        height: 30rpx;</span><br><span class="line">        margin-right: 10rpx;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.user-box &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    border-radius: 8rpx; </span><br><span class="line">    margin-bottom: 30rpx;</span><br><span class="line">    margin-top: -115rpx;</span><br><span class="line">    box-shadow: $box-shadow;</span><br><span class="line">    display:flex;</span><br><span class="line">    dis-di:column;</span><br><span class="line">    backgroud-color:#ffffff;</span><br><span class="line">&#125;</span><br><span class="line">.user-info &#123;</span><br><span class="line">    display:flex;</span><br><span class="line">    align-item:center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.avatar &#123;</span><br><span class="line">    position: relative;</span><br><span class="line">    margin-top: -35rpx;</span><br><span class="line">    margin-left: 35rpx;</span><br><span class="line">    margin-right: 35rpx;</span><br><span class="line">    width: 160rpx;</span><br><span class="line">    height: 160rpx;</span><br><span class="line">    border-radius: 100%;</span><br><span class="line">    display: flex;</span><br><span class="line">    align-items: center;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    background-color: #FFFFFF;</span><br><span class="line">    box-shadow: 0 0 20rpx rgba($color: #000000, $alpha: 0.2);</span><br><span class="line">    </span><br><span class="line">    image &#123;</span><br><span class="line">        width: 140rpx;</span><br><span class="line">        height: 140rpx;</span><br><span class="line">        border-radius: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    .badge &#123;</span><br><span class="line">        position: absolute;</span><br><span class="line">        right: -10rpx;</span><br><span class="line">        bottom: -10rpx;</span><br><span class="line">        background-color: #FFFFFF;</span><br><span class="line">        border-radius: 50rem;</span><br><span class="line">        display: flex;</span><br><span class="line">        align-items: center;</span><br><span class="line">        justify-content: center;</span><br><span class="line">        color: $color-warning;</span><br><span class="line">        font-size: 24rpx;</span><br><span class="line">        padding: 8rpx 16rpx;</span><br><span class="line">        box-shadow: 0 0 20rpx rgba($color: #000000, $alpha: 0.2);</span><br><span class="line">        </span><br><span class="line">        image &#123;</span><br><span class="line">            width: 30rpx;</span><br><span class="line">            height: 30rpx;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.level-benefit &#123;</span><br><span class="line">    margin-left: 35rpx;</span><br><span class="line">    padding: 10rpx 0 10rpx 30rpx;</span><br><span class="line">    border-radius: 50rem 0 0 50rem;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.user-grid &#123;</span><br><span class="line">    width: 25%;</span><br><span class="line">    padding: 30rpx;</span><br><span class="line">    display: flex;</span><br><span class="line">    flex-direction: column;</span><br><span class="line">    align-items: center;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    </span><br><span class="line">    .value &#123;</span><br><span class="line">        margin-bottom: 20rpx;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.level-benefit-box &#123;</span><br><span class="line">    border-radius: 8rpx; </span><br><span class="line">    margin-bottom: 30rpx;</span><br><span class="line">    box-shadow: 0 10rpx 8rpx rgba($color: #878889, $alpha: 0.1);</span><br><span class="line">    width: 100%;</span><br><span class="line">    display: flex;</span><br><span class="line">    padding: 30rpx;</span><br><span class="line">    flex-direction: column;</span><br><span class="line">    background-color: #FFFFFF;</span><br><span class="line">    </span><br><span class="line">    .row &#123;</span><br><span class="line">        display: flex;</span><br><span class="line">        padding: 30rpx 0 20rpx;</span><br><span class="line">        justify-content: space-around;</span><br><span class="line">        align-items: center;</span><br><span class="line">        </span><br><span class="line">        .grid &#123;</span><br><span class="line">            width: 20%;</span><br><span class="line">            display: flex;</span><br><span class="line">            flex-direction: column;</span><br><span class="line">            font-size: $font-size-sm;</span><br><span class="line">            color: $text-color-assist;</span><br><span class="line">            align-items: center;</span><br><span class="line"></span><br><span class="line">            image &#123;</span><br><span class="line">                width: 80rpx;</span><br><span class="line">                height: 80rpx;</span><br><span class="line">                margin-bottom: 10rpx;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.banner &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    border-radius: 8rpx;</span><br><span class="line">    margin-bottom: 30rpx;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.service-box &#123;</span><br><span class="line">    width: 100%;</span><br><span class="line">    background-color: #FFFFFF;</span><br><span class="line">    padding: 32rpx 30rpx 10rpx;</span><br><span class="line">    box-shadow: $box-shadow;</span><br><span class="line">    </span><br><span class="line">    .row &#123;</span><br><span class="line">        display: flex;</span><br><span class="line">        flex-wrap: wrap;</span><br><span class="line">        color: $text-color-assist;</span><br><span class="line">        font-size: $font-size-sm;</span><br><span class="line">        padding-bottom: -40rpx;</span><br><span class="line">        </span><br><span class="line">        .grid &#123;</span><br><span class="line">            display: flex;</span><br><span class="line">            flex-direction: column;</span><br><span class="line">            justify-content: center;</span><br><span class="line">            align-items: center;</span><br><span class="line">            margin-bottom: 40rpx;</span><br><span class="line">            width: 25%;</span><br><span class="line">            position: relative;</span><br><span class="line">            </span><br><span class="line">            .image &#123;</span><br><span class="line">                image &#123;</span><br><span class="line">                    width: 80rpx;</span><br><span class="line">                    height: 80rpx;</span><br><span class="line">                    margin-bottom: 20rpx;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .new-badage &#123;</span><br><span class="line">                width: 40rpx;</span><br><span class="line">                height: 40rpx;</span><br><span class="line">                position: absolute;</span><br><span class="line">                top: 0;</span><br><span class="line">                right: 30rpx;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="我的地址模块开发"><a href="#我的地址模块开发" class="headerlink" title="我的地址模块开发"></a>我的地址模块开发</h2><h4 id="validateToken验证"><a href="#validateToken验证" class="headerlink" title="validateToken验证"></a>validateToken验证</h4><p>jwt编码解码模块流程实现</p>
<p>生成token存在weichat</p>
<p>storage当中</p>
<p>提取storage缓存的token向服务器提交验证登录用户的鉴权</p>
<p>然后再返回用户个人数据</p>
<p><strong>【unicloud】端新建云函数vadidateToken</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;引入库包</span><br><span class="line">const jwt &#x3D; require(&#39;jwt-simple&#39;)</span><br><span class="line">const db &#x3D; uniCloud.database()</span><br></pre></td></tr></table></figure>

<h4 id="token"><a href="#token" class="headerlink" title="token"></a>token</h4><p>整个token 分为三部分：头部（header)、载荷（payload, )、签证（signature)，上方截图中的token字符串是由此三部分经过base64加密得到的</p>
<p>解码token，得到openId</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const token &#x3D; event.token</span><br><span class="line">    const userFromToken &#x3D; JSON.parse(Buffer.from(token.split(&#39;.&#39;)[1], &#39;base64&#39;).toString())</span><br></pre></td></tr></table></figure>

<p><strong>验证数据库有无此openId用户</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const userInDB &#x3D; await db.collection(&#39;users&#39;).where(&#123;openId:userFromToken&#125;).get()</span><br><span class="line">    if (userInDB.data.length !&#x3D;&#x3D; 1) &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        status: -1,</span><br><span class="line">        errCode: &#39;TOKEN_INVALID&#39;,</span><br><span class="line">        msg: &#39;查无此人&#39;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>解码token</strong></p>
<p>并且通过验证exp时间判断token是否过期</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">const userInfoDB &#x3D; userInDB.data[0]</span><br><span class="line">    let userInfoDecode</span><br><span class="line">    </span><br><span class="line">    userInfoDecode &#x3D; jwt.decode(token, userInfoDB.tokenSecret)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    if (userInfoDB.exp &gt; Date.now() &amp;&amp; userInfoDecode &#x3D;&#x3D; userFromToken ) &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        status: 0,</span><br><span class="line">        openId: userInfoDecode,</span><br><span class="line">        msg: &#39;token验证成功&#39;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>如果时间超过token下发时限则判断为失效</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if (userInfoDB.exp &lt; Date.now()) &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        status: -3,</span><br><span class="line">        errCode: &#39;TOKEN_EXPIRED&#39;,</span><br><span class="line">        msg: &#39;token已失效&#39;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h4 id="地址列表查询"><a href="#地址列表查询" class="headerlink" title="地址列表查询"></a>地址列表查询</h4><p>首页外卖入口添加address链接</p>
<p>地址首先样式拷贝</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">.main &#123;</span><br><span class="line">        width: 100%;</span><br><span class="line">        padding: 30rpx;</span><br><span class="line">        display: flex;</span><br><span class="line">        flex-direction: column;</span><br><span class="line">        </span><br><span class="line">        .address-wrapper &#123;</span><br><span class="line">            margin-bottom: 30rpx;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .address &#123;</span><br><span class="line">            width: 100%;</span><br><span class="line">            padding: 40rpx 30rpx;</span><br><span class="line">            background-color: #FFFFFF;</span><br><span class="line">            display: flex;</span><br><span class="line">            justify-content: space-between;</span><br><span class="line">            align-items: center;</span><br><span class="line">            margin-bottom: 10rpx;</span><br><span class="line">            </span><br><span class="line">            .right &#123;</span><br><span class="line">                flex: 1;</span><br><span class="line">                overflow: hidden;</span><br><span class="line">                display: flex;</span><br><span class="line">                flex-direction: column;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .edit-icon &#123;</span><br><span class="line">                width: 50rpx;</span><br><span class="line">                height: 50rpx;</span><br><span class="line">                flex-shrink: 0;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .address-button &#123;</span><br><span class="line">            height: 100rpx;</span><br><span class="line">            position: fixed;</span><br><span class="line">            bottom: 0;</span><br><span class="line">            left: 0;</span><br><span class="line">            right: 0;</span><br><span class="line">            padding: 10rpx 0;</span><br><span class="line">            display: flex;</span><br><span class="line">            align-items: center;</span><br><span class="line">            justify-content: center;</span><br><span class="line">            </span><br><span class="line">            button &#123;</span><br><span class="line">                height: 80rpx;</span><br><span class="line">                width: 80%;</span><br><span class="line">                border-radius: 50rem !important;</span><br><span class="line">                display: flex;</span><br><span class="line">                align-items: center;</span><br><span class="line">                justify-content: center;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>首先创建一个数组addressList</p>
<p>如果地址列表不存在则显示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;view v-if&#x3D;&quot;!addressList.length&quot; style&#x3D;&quot;color: #878889;&quot;&gt;</span><br><span class="line">                &lt;view&gt;暂无地址信息&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view&gt;请点击底部按钮添加地址信息&lt;&#x2F;view&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br></pre></td></tr></table></figure>

<p>用户地址如果存在</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class&#x3D;&quot;main&quot;&gt;</span><br><span class="line">            &lt;view v-if&#x3D;&quot;!addressList.length&quot; style&#x3D;&quot;color: #878889;&quot;&gt;</span><br><span class="line">                &lt;view&gt;暂无地址信息&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view&gt;请点击底部按钮添加地址信息&lt;&#x2F;view&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">            &lt;template v-else&gt;</span><br><span class="line">                &lt;uni-swipe-action&gt;</span><br><span class="line">                    &lt;uni-swipe-action-item class&#x3D;&quot;address-wrapper&quot; :options&#x3D;&quot;swipeOption&quot; @click&#x3D;&quot;handleSwipeClick(address._id)&quot; v-for&#x3D;&quot;(address, index) in addressList&quot; :key&#x3D;&quot;index&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;address&quot; @tap&#x3D;&quot;chooseAddress(address)&quot;&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;left flex-fill overflow-hidden mr-20&quot;&gt;</span><br><span class="line">                                &lt;view class&#x3D;&quot;font-size-lg font-weight-bold text-truncate&quot; style&#x3D;&quot;margin-bottom: 10rpx;&quot;&gt;&#123;&#123; address.street &#125;&#125;&lt;&#x2F;view&gt;</span><br><span class="line">                                &lt;view class&#x3D;&quot;font-size-sm text-color-assist&quot;&gt;</span><br><span class="line">                                    &#123;&#123; address.accept_name &#125;&#125; &#123;&#123; !address.gender ? &#39;先生&#39; : &#39;女士&#39; &#125;&#125; &#123;&#123; address.mobile &#125;&#125;</span><br><span class="line">                                &lt;&#x2F;view&gt;</span><br><span class="line">                            &lt;&#x2F;view&gt;</span><br><span class="line">                            &lt;image src&#x3D;&quot;&#x2F;static&#x2F;images&#x2F;edit.png&quot; class&#x3D;&quot;edit-icon&quot; @tap&#x3D;&quot;edit(address._id)&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;uni-swipe-action-item&gt;</span><br><span class="line">                &lt;&#x2F;uni-swipe-action&gt;</span><br><span class="line">            &lt;&#x2F;template&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;address-button&quot;&gt;</span><br><span class="line">                &lt;button type&#x3D;&quot;primary&quot;  size&#x3D;&quot;default&quot; @tap&#x3D;&quot;add&quot;&gt;新增地址&lt;&#x2F;button&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">        &lt;&#x2F;view&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<p>在script中添加</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">data () &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        addressList:[],</span><br><span class="line">        swipeOption: [</span><br><span class="line">            &#123;</span><br><span class="line">                text: &#39;删除&#39;,</span><br><span class="line">                style: &#123;</span><br><span class="line">                    backgroundColor: &#39;#D12E32&#39;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>计算属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">onLoad() &#123;</span><br><span class="line">            this.getAddress()</span><br><span class="line">        &#125;,</span><br></pre></td></tr></table></figure>

<p>方法函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">getAddress() &#123;</span><br><span class="line">                uni.showLoading(&#123;</span><br><span class="line">                    title:&#39;数据加载中...&#39;</span><br><span class="line">                &#125;);</span><br><span class="line">                return uniCloud.callFunction(&#123;</span><br><span class="line">                    name:&#39;validateToken&#39;,</span><br><span class="line">                    data:&#123;</span><br><span class="line">                        token:uni.getStorageSync(&#39;token&#39;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;).then((res)&#x3D;&gt;&#123;</span><br><span class="line">                    if(res.result.status &#x3D;&#x3D;&#x3D; 0) &#123;</span><br><span class="line">                        uni.hideLoading()</span><br><span class="line">                        return uniCloud.callFunction(&#123;</span><br><span class="line">                            name:&#39;getAddress&#39;,</span><br><span class="line">                            </span><br><span class="line">                            data:&#123;</span><br><span class="line">                                openId:res.result.openId</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        uni.hideLoading()</span><br><span class="line">                        uni.showModal(&#123;</span><br><span class="line">                            content: res.result.msg,</span><br><span class="line">                            showCancel: false</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;).then((resData) &#x3D;&gt;&#123;</span><br><span class="line">                    this.addressList &#x3D; resData.result.data</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<p>【unicloud】新建getAddress云函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">const openId &#x3D; event.openId</span><br><span class="line">        const res &#x3D; await db.collection(&#39;addresses&#39;).where(&#123;openId&#125;).get()</span><br><span class="line">        const resData &#x3D; res.data</span><br><span class="line">        return &#123;</span><br><span class="line">            status:0,</span><br><span class="line">            data:resData</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<h4 id="地址列表删除"><a href="#地址列表删除" class="headerlink" title="地址列表删除"></a><strong>地址列表删除</strong></h4><p>uni-app端函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 删除地址</span><br><span class="line">            handleClickOption(id) &#123;</span><br><span class="line">                uni.showModal(&#123;</span><br><span class="line">                    title: &#39;提示&#39;,</span><br><span class="line">                    content: &#39;确定要删除？&#39;,</span><br><span class="line">                    success: res &#x3D;&gt; &#123;</span><br><span class="line">                        if(res.confirm) &#123;</span><br><span class="line">                            return uniCloud.callFunction(&#123;</span><br><span class="line">                                name:&#39;deleteAddress&#39;,</span><br><span class="line">                                data:&#123;id:id&#125;</span><br><span class="line">                            &#125;).then((res)&#x3D;&gt;&#123;</span><br><span class="line">                                console.log(res)</span><br><span class="line">                                if(res.result.status &#x3D;&#x3D;&#x3D; 0) &#123;</span><br><span class="line">                                    uni.showToast(&#123;title: &#39;删除成功！&#39;, icon: &#39;success&#39;&#125;)</span><br><span class="line">                                    this.getAddress()</span><br><span class="line">                                &#125;</span><br><span class="line">                                uni.showModal(&#123;</span><br><span class="line">                                    content: res.result.msg,</span><br><span class="line">                                    showCancel: false</span><br><span class="line">                                &#125;)</span><br><span class="line">                            &#125;)</span><br><span class="line">                            </span><br><span class="line">                            </span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;,</span><br></pre></td></tr></table></figure>

<p>【unicloud云函数】deleteAddress</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#39;use strict&#39;;</span><br><span class="line">const db &#x3D; uniCloud.database()</span><br><span class="line">exports.main &#x3D; async (event, context) &#x3D;&gt; &#123;</span><br><span class="line">  const _id &#x3D; event.id</span><br><span class="line">  const res &#x3D; await db.collection(&#39;addresses&#39;).where(&#123;_id&#125;).remove()</span><br><span class="line"> </span><br><span class="line">  if(res.requestId)&#123;</span><br><span class="line">      return &#123;</span><br><span class="line">          status:0,</span><br><span class="line">          msg:&#39;删除成功&#39;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">        return &#123;</span><br><span class="line">            status:-1,</span><br><span class="line">            msg:&#39;删除失败&#39;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="用户新增地址"><a href="#用户新增地址" class="headerlink" title="用户新增地址"></a><strong>用户新增地址</strong></h4><p>地址列表添加button,新增地址</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class&#x3D;&quot;address-button&quot;&gt;</span><br><span class="line">                &lt;button type&#x3D;&quot;primary&quot;  size&#x3D;&quot;default&quot; @tap&#x3D;&quot;add&quot;&gt;新增地址&lt;&#x2F;button&gt;</span><br><span class="line">&lt;&#x2F;view&gt;</span><br></pre></td></tr></table></figure>

<p>跳转到add.vue,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 添加地址</span><br><span class="line">            add() &#123;</span><br><span class="line">                uni.navigateTo(&#123;</span><br><span class="line">                    url:&#39;&#x2F;pages&#x2F;address&#x2F;add&#39;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;,</span><br></pre></td></tr></table></figure>

<p>新增地址页面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;view class&#x3D;&quot;container&quot;&gt;</span><br><span class="line">        &lt;view class&#x3D;&quot;form-box&quot;&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;form&quot;&gt;</span><br><span class="line">                &lt;list-cell :hover&#x3D;&quot;false&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;form-input&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;label&quot;&gt;收货人&lt;&#x2F;view&gt;</span><br><span class="line">                         &lt;input class&#x3D;&quot;input&quot; placeholder&#x3D;&quot;请输入收货人&quot; v-model&#x3D;&quot;form.accept_name&quot; placeholder-class&#x3D;&quot;text-color-assist&quot;&#x2F;&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;list-cell&gt;</span><br><span class="line">                &lt;list-cell :hover&#x3D;&quot;false&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;form-input&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;label&quot;&gt;性别&lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;radio-group&quot;&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;radio&quot; :class&#x3D;&quot;&#123;&#39;checked&#39;: !form.gender&#125;&quot; style&#x3D;&quot;margin-right: 10rpx;&quot; @tap&#x3D;&quot;form.gender&#x3D;0&quot;&gt;先生&lt;&#x2F;view&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;radio&quot; :class&#x3D;&quot;&#123;&#39;checked&#39;: form.gender&#125;&quot; @tap&#x3D;&quot;form.gender&#x3D;1&quot;&gt;女士&lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;list-cell&gt;</span><br><span class="line">                &lt;list-cell :hover&#x3D;&quot;false&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;form-input&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;label&quot;&gt;联系方式&lt;&#x2F;view&gt;</span><br><span class="line">                         &lt;input class&#x3D;&quot;input&quot; placeholder&#x3D;&quot;请输入收货人联系方式&quot; v-model&#x3D;&quot;form.mobile&quot; placeholder-class&#x3D;&quot;text-color-assist&quot;&#x2F;&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;list-cell&gt;</span><br><span class="line">                &lt;list-cell :hover&#x3D;&quot;false&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;form-input&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;label&quot;&gt;所在区域&lt;&#x2F;view&gt;</span><br><span class="line">                         &lt;input class&#x3D;&quot;input&quot; placeholder&#x3D;&quot;请输入所在区域&quot; v-model&#x3D;&quot;form.area&quot; placeholder-class&#x3D;&quot;text-color-assist&quot;&#x2F;&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;list-cell&gt;</span><br><span class="line">                &lt;list-cell :hover&#x3D;&quot;false&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;form-input&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;label&quot;&gt;收货地址&lt;&#x2F;view&gt;</span><br><span class="line">                         &lt;input class&#x3D;&quot;input&quot; placeholder&#x3D;&quot;请输入收货人详细地址&quot; v-model&#x3D;&quot;form.street&quot; placeholder-class&#x3D;&quot;text-color-assist&quot;&#x2F;&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;list-cell&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;btn-section&quot;&gt;</span><br><span class="line">                &lt;button type&#x3D;&quot;primary&quot; size&#x3D;&quot;default&quot; @tap&#x3D;&quot;save&quot;&gt;保存&lt;&#x2F;button&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">        &lt;&#x2F;view&gt;</span><br><span class="line">    &lt;&#x2F;view&gt;</span><br><span class="line">&lt;&#x2F;template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    import listCell from &#39;@&#x2F;components&#x2F;list-cell&#x2F;list-cell&#39;</span><br><span class="line">    </span><br><span class="line">    export default &#123;</span><br><span class="line">        components: &#123;</span><br><span class="line">            listCell</span><br><span class="line">        &#125;,</span><br><span class="line">        data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                form: &#123;</span><br><span class="line">                    accept_name: &#39;&#39;,</span><br><span class="line">                    gender: 0,</span><br><span class="line">                    mobile: &#39;&#39;,</span><br><span class="line">                    area:&#39;&#39;,</span><br><span class="line">                    street: &#39;&#39;,</span><br><span class="line">                    openId:&#39;&#39;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    </span><br><span class="line">        methods: &#123;</span><br><span class="line">            save() &#123;</span><br><span class="line">                let data &#x3D; this.form</span><br><span class="line">                return uniCloud.callFunction(&#123;</span><br><span class="line">                    name:&#39;validateToken&#39;,</span><br><span class="line">                    data:&#123;</span><br><span class="line">                        token:uni.getStorageSync(&#39;token&#39;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;).then((res)&#x3D;&gt;&#123;</span><br><span class="line">                    if(res.result.status &#x3D;&#x3D;&#x3D; 0)&#123;</span><br><span class="line">                        this.form.openId &#x3D; res.result.openId</span><br><span class="line">                        return uniCloud.callFunction(&#123;</span><br><span class="line">                            name:&#39;addAddress&#39;,</span><br><span class="line">                            data:&#123;</span><br><span class="line">                                data</span><br><span class="line">                                </span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;).then((res)&#x3D;&gt;&#123;</span><br><span class="line">                            if(res.result.status &#x3D;&#x3D;&#x3D; 0) &#123;</span><br><span class="line">                                uni.showToast(&#123;</span><br><span class="line">                                    title:&#39;添加成功&#39;</span><br><span class="line">                                &#125;)</span><br><span class="line">                                uni.navigateBack(&#123;</span><br><span class="line">                                    </span><br><span class="line">                                &#125;)</span><br><span class="line">                            &#125; else &#123;</span><br><span class="line">                                uni.showModal(&#123;</span><br><span class="line">                                    content:res.result.msg,</span><br><span class="line">                                    showCancel:false</span><br><span class="line">                                &#125;)</span><br><span class="line">                            &#125;</span><br><span class="line">                            </span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang&#x3D;&quot;scss&quot; scoped&gt;</span><br><span class="line">    .form-box &#123;</span><br><span class="line">        width: 100%;</span><br><span class="line">        height: 100%;</span><br><span class="line">        padding: 30rpx;</span><br><span class="line">        display: flex;</span><br><span class="line">        flex-direction: column;</span><br><span class="line">        color: $text-color-base;</span><br><span class="line">        </span><br><span class="line">        .form-input &#123;</span><br><span class="line">            display: flex;</span><br><span class="line">            align-items: center;</span><br><span class="line">            width: 100%;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .label &#123;</span><br><span class="line">            width: 200rpx;</span><br><span class="line">            font-size: $font-size-lg;</span><br><span class="line">            color: $text-color-base;</span><br><span class="line">            font-weight: 500;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .input &#123;</span><br><span class="line">            flex: 1;</span><br><span class="line">            display: flex;</span><br><span class="line">            align-items: center;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .radio-group &#123;</span><br><span class="line">            display: flex;</span><br><span class="line">            justify-content: flex-start;</span><br><span class="line">            </span><br><span class="line">            .radio &#123;</span><br><span class="line">                padding: 10rpx 30rpx;</span><br><span class="line">                border-radius: 6rpx;</span><br><span class="line">                border: 2rpx solid $text-color-assist;</span><br><span class="line">                color: $text-color-assist;</span><br><span class="line">                font-size: $font-size-base;</span><br><span class="line">                </span><br><span class="line">                &amp;.checked &#123;</span><br><span class="line">                    background-color: $color-primary;</span><br><span class="line">                    color: $text-color-white;</span><br><span class="line">                    border: 2rpx solid $color-primary;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .btn-section &#123;</span><br><span class="line">            flex: 1;</span><br><span class="line">            display: flex;</span><br><span class="line">            align-items: center;</span><br><span class="line">            justify-content: center;</span><br><span class="line">            </span><br><span class="line">            button &#123;</span><br><span class="line">                font-size: $font-size-base;</span><br><span class="line">                height: 90rpx;</span><br><span class="line">                border-radius: 50rem !important;</span><br><span class="line">                width: 85%;</span><br><span class="line">                display: flex;</span><br><span class="line">                align-items: center;</span><br><span class="line">                justify-content: center;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;&#x2F;style&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在pages.json中注册add.vue</p>
<p><strong>【unicloud】写addAddress接口</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#39;use strict&#39;;</span><br><span class="line">const db &#x3D; uniCloud.database()</span><br><span class="line">exports.main &#x3D; async (event, context) &#x3D;&gt; &#123;</span><br><span class="line">  const data &#x3D; event.data</span><br><span class="line">  const street &#x3D; event.data.street</span><br><span class="line">  const addressDB &#x3D; await db.collection(&#39;addresses&#39;).where(&#123;street&#125;).get()</span><br><span class="line">  if(addressDB.data.length &#x3D;&#x3D;&#x3D;0)&#123;</span><br><span class="line">      const res &#x3D; await db.collection(&#39;addresses&#39;).add(data)</span><br><span class="line">      return &#123;</span><br><span class="line">          status:0,</span><br><span class="line">          msg:&#39;添加成功&#39;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">    return &#123;</span><br><span class="line">        status:-1,</span><br><span class="line">        msg:&#39;地址已存在&#39;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="修改用户地址"><a href="#修改用户地址" class="headerlink" title="修改用户地址"></a>修改用户地址</h4><h5 id="1-address-vue页面edit-触发事件"><a href="#1-address-vue页面edit-触发事件" class="headerlink" title="1.address.vue页面edit 触发事件"></a>1.address.vue页面edit 触发事件</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">引入 import &#123;mapState,mapMutations&#125; from &#39;vuex&#39;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">computed:&#123;</span><br><span class="line">            ...mapState([&#39;choseAddress&#39;])</span><br><span class="line">        &#125;,</span><br><span class="line">        </span><br></pre></td></tr></table></figure>

<p>在methds当中引入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">...mapMutations([&#39;SET_ADDRESS&#39;]),</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">edit(address) &#123;</span><br><span class="line">                </span><br><span class="line">                this.SET_ADDRESS(address)</span><br><span class="line">            </span><br><span class="line">                uni.navigateTo(&#123;</span><br><span class="line">                    url:&#39;&#x2F;pages&#x2F;address&#x2F;edit&#39;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<h5 id="2-edit-vue界面"><a href="#2-edit-vue界面" class="headerlink" title="2.edit.vue界面"></a>2.edit.vue界面</h5><p>template和css样式我照add.vue </p>
<p>js这边 choseAddress</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                form: &#123;</span><br><span class="line">                    _id:&#39;&#39;,</span><br><span class="line">                    accept_name: &#39;&#39;,</span><br><span class="line">                    gender: &#39;&#39;,</span><br><span class="line">                    mobile: &#39;&#39;,</span><br><span class="line">                    street: &#39;&#39;,</span><br><span class="line">                    area: &#39;&#39;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        computed:&#123;</span><br><span class="line">            ...mapState([&#39;choseAddress&#39;])</span><br><span class="line">        &#125;,</span><br><span class="line">        onLoad() &#123;</span><br><span class="line">            this.form &#x3D; this.choseAddress</span><br><span class="line">            </span><br><span class="line">        &#125;,</span><br><span class="line">        methods:&#123;</span><br><span class="line">            editSave()&#123;</span><br><span class="line">                let data &#x3D; this.form</span><br><span class="line">                console.log(data)</span><br><span class="line">                return uniCloud.callFunction(&#123;</span><br><span class="line">                    name:&#39;editAddress&#39;,</span><br><span class="line">                    data:&#123;</span><br><span class="line">                        data</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;).then(res &#x3D;&gt;&#123;</span><br><span class="line">                    if(res.result.status &#x3D;&#x3D;&#x3D; 0) &#123;</span><br><span class="line">                        uni.showToast(&#123;</span><br><span class="line">                            title:&#39;修改成功&#39;</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>3.【unicloud】端editAddress函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#39;use strict&#39;;</span><br><span class="line">const db &#x3D; uniCloud.database()</span><br><span class="line">exports.main &#x3D; async (event, context) &#x3D;&gt; &#123;</span><br><span class="line">  let _id &#x3D; event.data._id</span><br><span class="line">  let fields &#x3D; &#123;</span><br><span class="line">      accept_name: event.data.accept_name,</span><br><span class="line">      gender: event.data.gender,</span><br><span class="line">      mobile: event.data.mobile,</span><br><span class="line">      area:event.data.area,</span><br><span class="line">      street: event.data.street</span><br><span class="line">  &#125;</span><br><span class="line">  const res &#x3D; await db.collection(&#39;addresses&#39;).where(&#123;_id&#125;).update(&#123;...fields&#125;)</span><br><span class="line">    if(res.updated &#x3D;&#x3D;&#x3D; 1)&#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            status:0,</span><br><span class="line">            msg:&#39;数据修改成功&#39;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else if(res.updated &#x3D;&#x3D;&#x3D; 0) &#123;</span><br><span class="line">        return &#123;</span><br><span class="line">            status:-1,</span><br><span class="line">            msg:&#39;地址未改变&#39;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="云函数合并"><a href="#云函数合并" class="headerlink" title="云函数合并"></a>云函数合并</h4><p>之前我们address模块更删改查共分了4个云函数</p>
<p>如果合并在一起，看起来会更加美观优雅</p>
<p>【unicloud】后端部分用address函数整合get\add\edit\delete</p>
<p>uni-app前端 unicloud.callfuction函数data中添加action</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&#39;use strict&#39;;</span><br><span class="line">const db &#x3D; uniCloud.database()</span><br><span class="line">exports.main &#x3D; async (event, context) &#x3D;&gt; &#123;</span><br><span class="line">  if(event.action &#x3D;&#x3D; &#39;getList&#39;) &#123;</span><br><span class="line">      const openId &#x3D; event.openId</span><br><span class="line">      const res &#x3D; await db.collection(&#39;addresses&#39;).where(&#123;openId&#125;).get()</span><br><span class="line">      const resData &#x3D; res.data</span><br><span class="line">      return &#123;</span><br><span class="line">          status:0,</span><br><span class="line">          data:resData</span><br><span class="line">      &#125;</span><br><span class="line">  &#125; else if(event.action &#x3D;&#x3D; &#39;deleteAddress&#39;) &#123;</span><br><span class="line">      const _id &#x3D; event.id</span><br><span class="line">      const res &#x3D; await db.collection(&#39;addresses&#39;).where(&#123;_id&#125;).remove()</span><br><span class="line">       </span><br><span class="line">      if(res.requestId)&#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                status:0,</span><br><span class="line">                msg:&#39;删除成功&#39;</span><br><span class="line">            &#125;</span><br><span class="line">      &#125;</span><br><span class="line">              return &#123;</span><br><span class="line">                  status:-1,</span><br><span class="line">                  msg:&#39;删除失败&#39;</span><br><span class="line">              &#125;</span><br><span class="line">  &#125; else if(event.action &#x3D;&#x3D; &#39;addAddress&#39;) &#123;</span><br><span class="line">      const data &#x3D; event.data</span><br><span class="line">      const street &#x3D; event.data.street</span><br><span class="line">      const addressDB &#x3D; await db.collection(&#39;addresses&#39;).where(&#123;street&#125;).get()</span><br><span class="line">      if(addressDB.data.length &#x3D;&#x3D;&#x3D;0)&#123;</span><br><span class="line">            const res &#x3D; await db.collection(&#39;addresses&#39;).add(data)</span><br><span class="line">            return &#123;</span><br><span class="line">                status:0,</span><br><span class="line">                msg:&#39;添加成功&#39;</span><br><span class="line">            &#125;</span><br><span class="line">      &#125;</span><br><span class="line">          return &#123;</span><br><span class="line">              status:-1,</span><br><span class="line">              msg:&#39;地址已存在&#39;</span><br><span class="line">          &#125;</span><br><span class="line">  &#125; else if(event.action &#x3D;&#x3D; &#39;editAddress&#39;) &#123;</span><br><span class="line">      let _id &#x3D; event.data._id</span><br><span class="line">      let fields &#x3D; &#123;</span><br><span class="line">            accept_name: event.data.accept_name,</span><br><span class="line">            gender: event.data.gender,</span><br><span class="line">            mobile: event.data.mobile,</span><br><span class="line">            area:event.data.area,</span><br><span class="line">            street: event.data.street</span><br><span class="line">      &#125;</span><br><span class="line">      const res &#x3D; await db.collection(&#39;addresses&#39;).where(&#123;_id&#125;).update(&#123;...fields&#125;)</span><br><span class="line">          if(res.updated &#x3D;&#x3D;&#x3D; 1)&#123;</span><br><span class="line">              return &#123;</span><br><span class="line">                  status:0,</span><br><span class="line">                  msg:&#39;数据修改成功&#39;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125; else if(res.updated &#x3D;&#x3D;&#x3D; 0) &#123;</span><br><span class="line">              return &#123;</span><br><span class="line">                  status:-1,</span><br><span class="line">                  msg:&#39;地址未改变&#39;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="门店选择模块开发"><a href="#门店选择模块开发" class="headerlink" title="门店选择模块开发"></a>门店选择模块开发</h2><p>​    uni-app的map 组件</p>
<p>目前uni-app支持的小程序</p>
<table>
<thead>
<tr>
<th align="center">App</th>
<th align="center">H5</th>
<th align="center">微信小程序</th>
<th align="center">支付宝小程序</th>
<th align="center">百度小程序</th>
<th align="center">字节跳动小程序</th>
<th align="center">QQ小程序</th>
<th align="center">快应用</th>
<th align="center">360小程序</th>
</tr>
</thead>
<tbody><tr>
<td align="center">√</td>
<td align="center">√</td>
<td align="center">√</td>
<td align="center">√</td>
<td align="center">√</td>
<td align="center">1.63+</td>
<td align="center">1.9.0+</td>
<td align="center">√</td>
<td align="center">x</td>
</tr>
</tbody></table>
<p><strong>门店选择模块</strong></p>
<ul>
<li>定位附近门店</li>
<li>计算最近门店距离</li>
<li>展示门店信息列表</li>
</ul>
<h4 id="首先我们了解下小程序map组件"><a href="#首先我们了解下小程序map组件" class="headerlink" title="首先我们了解下小程序map组件"></a>首先我们了解下小程序map组件</h4><p>uni-app map组件官网</p>
<p><a target="_blank" rel="noopener" href="https://uniapp.dcloud.io/component/map?id=map">https://uniapp.dcloud.io/component/map?id=map</a></p>
<table>
<thead>
<tr>
<th align="left">属性名</th>
<th align="left">类型</th>
<th align="left">默认值</th>
<th align="left">说明</th>
<th align="left">平台差异说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">longitude</td>
<td align="left">Number</td>
<td align="left"></td>
<td align="left">中心经度</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">latitude</td>
<td align="left">Number</td>
<td align="left"></td>
<td align="left">中心纬度</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">scale</td>
<td align="left">Number</td>
<td align="left">16</td>
<td align="left">缩放级别，取值范围为5-18</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">markers</td>
<td align="left">Array</td>
<td align="left"></td>
<td align="left">标记点</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">polyline</td>
<td align="left">Array</td>
<td align="left"></td>
<td align="left">路线</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">circles</td>
<td align="left">Array</td>
<td align="left"></td>
<td align="left">圆</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">controls</td>
<td align="left">Array</td>
<td align="left"></td>
<td align="left">控件</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">include-points</td>
<td align="left">Array</td>
<td align="left"></td>
<td align="left">缩放视野以包含所有给定的坐标点</td>
<td align="left">App-nvue 2.1.5+、微信小程序、H5、百度小程序、支付宝小程序</td>
</tr>
<tr>
<td align="left">enable-3D</td>
<td align="left">Boolean</td>
<td align="left">false</td>
<td align="left">是否显示3D楼块</td>
<td align="left">App-nvue 2.1.5+、微信小程序2.3.0</td>
</tr>
<tr>
<td align="left">show-compass</td>
<td align="left">Boolean</td>
<td align="left">false</td>
<td align="left">是否显示指南针</td>
<td align="left">App-nvue 2.1.5+、微信小程序2.3.0</td>
</tr>
<tr>
<td align="left">enable-overlooking</td>
<td align="left">Boolean</td>
<td align="left">false</td>
<td align="left">是否开启俯视</td>
<td align="left">App-nvue 2.1.5+、微信小程序2.3.0</td>
</tr>
<tr>
<td align="left">enable-satellite</td>
<td align="left">Boolean</td>
<td align="left">false</td>
<td align="left">是否开启卫星图</td>
<td align="left">App-nvue 2.1.5+、微信小程序2.7.0</td>
</tr>
<tr>
<td align="left">enable-traffic</td>
<td align="left">Boolean</td>
<td align="left">false</td>
<td align="left">是否开启实时路况</td>
<td align="left">App-nvue 2.1.5+、微信小程序2.7.0</td>
</tr>
<tr>
<td align="left">show-location</td>
<td align="left">Boolean</td>
<td align="left"></td>
<td align="left">显示带有方向的当前定位点</td>
<td align="left">微信小程序、H5、百度小程序、支付宝小程序</td>
</tr>
<tr>
<td align="left">polygons</td>
<td align="left">Array.<code>&lt;polygon&gt;</code></td>
<td align="left"></td>
<td align="left">多边形</td>
<td align="left">App-nvue 2.1.5+、微信小程序、百度小程序、支付宝小程序</td>
</tr>
<tr>
<td align="left">@markertap</td>
<td align="left">EventHandle</td>
<td align="left"></td>
<td align="left">点击标记点时触发，e.detail = {markerId}</td>
<td align="left">App-nvue 2.3.3+, App平台需要指定 marker 对象属性 id</td>
</tr>
<tr>
<td align="left">@labeltap</td>
<td align="left">EventHandle</td>
<td align="left"></td>
<td align="left">点击label时触发，e.detail = {markerId}</td>
<td align="left">微信小程序2.9.0</td>
</tr>
<tr>
<td align="left">@callouttap</td>
<td align="left">EventHandle</td>
<td align="left"></td>
<td align="left">点击标记点对应的气泡时触发，e.detail = {markerId}</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">@controltap</td>
<td align="left">EventHandle</td>
<td align="left"></td>
<td align="left">点击控件时触发，e.detail = {controlId}</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">@regionchange</td>
<td align="left">EventHandle</td>
<td align="left"></td>
<td align="left">视野发生变化时触发</td>
<td align="left">微信小程序、H5、百度小程序、支付宝小程序</td>
</tr>
<tr>
<td align="left">@tap</td>
<td align="left">EventHandle</td>
<td align="left"></td>
<td align="left">点击地图时触发; App-nuve、微信小程序2.9支持返回经纬度</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">@updated</td>
<td align="left">EventHandle</td>
<td align="left"></td>
<td align="left">在地图渲染更新完成时触发</td>
<td align="left">微信小程序、H5、百度小程序</td>
</tr>
</tbody></table>
<h4 id="小程序获取用户位置"><a href="#小程序获取用户位置" class="headerlink" title="小程序获取用户位置"></a>小程序获取用户位置</h4><p><strong>uni.getLocation</strong></p>
<p>获取当前的地理位置、速度。 在微信小程序中，当用户离开应用后，此接口无法调用，除非申请后台持续定位权限；当用户点击“显示在聊天顶部”时，此接口可继续调用。</p>
<p>成功：latitude, longitude</p>
<h4 id="uni-app前端小程序页面开发"><a href="#uni-app前端小程序页面开发" class="headerlink" title="uni-app前端小程序页面开发"></a>uni-app前端小程序页面开发</h4><p>index首页页面，如果未有选择门店，则进入门店选择页面</p>
<p>takein() {<br>                if(!this.chooseStore) {<br>                    uni.navigateTo({<br>                        url:’../stores/stores’<br>                    })<br>                }<br>                {<br>                    this.$store.commit(‘SET_ORDERTYPE’,’takein’)<br>                uni.switchTab({<br>                    url:’../menu/menu’<br>                })<br>                }</p>
<p>首先是页面结构</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class&#x3D;&quot;container&quot;&gt;</span><br><span class="line">        &lt;!-- 门店地图标记 --&gt;</span><br><span class="line">        &lt;view class&#x3D;&quot;page-body&quot;&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;page-section&quot;&gt;</span><br><span class="line">                &lt;map id&#x3D;&quot;myMap&quot; style&#x3D;&quot;width: 100%; height: 400rpx;&quot; :latitude&#x3D;&quot;latitude&quot; :longitude&#x3D;&quot;longitude&quot;</span><br><span class="line">                :markers&#x3D;&quot;markers&quot;  &gt;</span><br><span class="line">                &lt;&#x2F;map&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">        &lt;&#x2F;view&gt;</span><br><span class="line">        &lt;view class&#x3D;&quot;content&quot;&gt;</span><br><span class="line">            &lt;view class&#x3D;&quot;store&quot; v-for&#x3D;&quot;(store,index) in storeData&quot; :key&#x3D;&quot;index&quot; @tap&#x3D;&quot;tapStore&quot;&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;store-left&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;store-title&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;store-name&quot;&gt;&#123;&#123;store.name&#125;&#125;&lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;store-status&quot;&gt;营业中&lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;store-content&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;store-distance&quot;&gt;距离您&#123;&#123;store.distance&#125;&#125;km&lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;text class&#x3D;&quot;store-text&quot;&gt;&#123;&#123;store.street&#125;&#125;&lt;&#x2F;text&gt;</span><br><span class="line">                        &lt;text class&#x3D;&quot;store-text&quot;&gt;营业时间：10：00-22:30&lt;&#x2F;text&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;store-rigth&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;look&quot;&gt;</span><br><span class="line">                        去看看</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;icon&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;round&quot;&gt;</span><br><span class="line">                            &lt;image src&#x3D;&quot;..&#x2F;..&#x2F;static&#x2F;images&#x2F;store&#x2F;store-tel.png&quot; &gt;&lt;&#x2F;image&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;round&quot;&gt;</span><br><span class="line">                            &lt;image src&#x3D;&quot;..&#x2F;..&#x2F;static&#x2F;images&#x2F;store&#x2F;store-nav.png&quot; &gt;&lt;&#x2F;image&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">        &lt;&#x2F;view&gt;</span><br><span class="line">    &lt;&#x2F;view&gt;</span><br></pre></td></tr></table></figure>

<p>css样式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">.content&#123;</span><br><span class="line">        width: 100%;</span><br><span class="line">        height: 100%;</span><br><span class="line">    &#125;</span><br><span class="line">    .page-body &#123;</span><br><span class="line">        text-align: center;</span><br><span class="line">        height: 400rpx;</span><br><span class="line">    &#125;</span><br><span class="line">    .page-section&#123;</span><br><span class="line">        z-index: 0;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    .store &#123;</span><br><span class="line">        display: flex;</span><br><span class="line">        flex-wrap: wrap;</span><br><span class="line">        padding:20rpx 30rpx;</span><br><span class="line">        background-color: #FFFFFF;</span><br><span class="line">        margin: 10rpx 20rpx 10rpx 20rpx;</span><br><span class="line">        box-shadow: $box-shadow;</span><br><span class="line">    &#125;</span><br><span class="line">    .store-left &#123;</span><br><span class="line">        width: 70%;</span><br><span class="line">        display: flex;</span><br><span class="line">        flex-direction: column;</span><br><span class="line">        .store-title &#123;</span><br><span class="line">            display: flex;</span><br><span class="line">            flex-wrap: nowrap;</span><br><span class="line">            .store-name &#123;</span><br><span class="line">                margin-right: 30rpx;</span><br><span class="line">                color: $text-color-black;</span><br><span class="line">                font-size: $font-size-lg;</span><br><span class="line">                font-weight: bold;</span><br><span class="line">                white-space: nowrap;</span><br><span class="line">                overflow: hidden;</span><br><span class="line">                text-overflow: ellipsis;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .store-status &#123;</span><br><span class="line">                display: flex;</span><br><span class="line">                flex-wrap: nowrap;</span><br><span class="line">                white-space: nowrap;</span><br><span class="line">                padding: 0 5rpx;</span><br><span class="line">                color: $color-primary;</span><br><span class="line">                border: 1rpx solid $color-primary;</span><br><span class="line">                font-size: $font-size-sm;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        .store-content &#123;</span><br><span class="line">            margin-top: 60rpx;</span><br><span class="line">            font-size: $font-size-sm;</span><br><span class="line">            display: flex;</span><br><span class="line">            flex-direction: column;</span><br><span class="line">            .store-text &#123;</span><br><span class="line">                color: $text-color-assist;</span><br><span class="line">                white-space: nowrap;</span><br><span class="line">                overflow: hidden;</span><br><span class="line">                text-overflow: ellipsis;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    .store-rigth &#123;</span><br><span class="line">        width: 30%;</span><br><span class="line">        display: flex;</span><br><span class="line">        flex-direction: column;</span><br><span class="line">        align-items: flex-end;</span><br><span class="line">        .look &#123;</span><br><span class="line">            font-size: $font-size-sm;</span><br><span class="line">            color: $color-primary;</span><br><span class="line">        &#125;</span><br><span class="line">        .icon &#123;</span><br><span class="line">            margin-top: 60rpx;</span><br><span class="line">            display: flex;</span><br><span class="line">            flex-wrap: nowrap;</span><br><span class="line">            align-items: center;</span><br><span class="line">            justify-content: flex-end;</span><br><span class="line">            .round &#123;</span><br><span class="line">                </span><br><span class="line">                border-radius: 50%;</span><br><span class="line">                width: 60rpx;</span><br><span class="line">                height: 60rpx;</span><br><span class="line">                background-color: #cad43f;</span><br><span class="line">                margin: 10rpx;</span><br><span class="line">                image &#123;</span><br><span class="line">                    display: block;</span><br><span class="line">                    width: 40rpx;</span><br><span class="line">                    height: 40rpx;</span><br><span class="line">                    border-radius: 50%;</span><br><span class="line">                    margin: 10rpx ;</span><br><span class="line">                    align-items: center;</span><br><span class="line">                    </span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>接收门店数据</p>
<h4 id="计算用户位置到门店距离并且排序显示最近的门店在markers标注上"><a href="#计算用户位置到门店距离并且排序显示最近的门店在markers标注上" class="headerlink" title="计算用户位置到门店距离并且排序显示最近的门店在markers标注上"></a>计算用户位置到门店距离并且排序显示最近的门店在markers标注上</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 两点间距离</span><br><span class="line">            distance(la1, lo1, la2, lo2) &#123;</span><br><span class="line">                var La1 &#x3D; la1 * Math.PI &#x2F; 180.0;</span><br><span class="line">                var La2 &#x3D; la2 * Math.PI &#x2F; 180.0;</span><br><span class="line">                var La3 &#x3D; La1 - La2;</span><br><span class="line">                var Lb3 &#x3D; lo1 * Math.PI &#x2F; 180.0 - lo2 * Math.PI &#x2F; 180.0;</span><br><span class="line">                var s &#x3D; 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(La3 &#x2F; 2), 2) + Math.cos(La1) * Math.cos(La2) * Math.pow(Math.sin(Lb3 &#x2F; 2), 2)));</span><br><span class="line">                s &#x3D; s * 6378.137;&#x2F;&#x2F;地球半径</span><br><span class="line">                s &#x3D; Math.round(s * 10000) &#x2F; 10000;</span><br><span class="line">                s &#x3D; s.toFixed(1);</span><br><span class="line">                return s</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<p>地球是一个近乎标准的椭球体，它的赤道半径为6378.140千米</p>
<p>它的半径就是地球的平均半径，记为R。如果以0度经线为基准，</p>
<p>那么根据地球表面任意两点的经纬度就可以计算出这两点间的地表距离</p>
<p>获取数据并且排序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">getStoreData()&#123;</span><br><span class="line">            return new Promise((resolve,reject) &#x3D;&gt;&#123;</span><br><span class="line">                &#x2F;&#x2F; 获取用户定位经纬度</span><br><span class="line">                uni.getLocation(&#123;</span><br><span class="line">                    type: &#39;gcj02&#39;,</span><br><span class="line">                    success:(localRes)&#x3D;&gt;&#123;</span><br><span class="line">                        if(localRes.latitude)&#123;</span><br><span class="line">                            resolve(localRes)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;).then(local &#x3D;&gt;&#123;</span><br><span class="line">                    let la1 &#x3D; local.latitude</span><br><span class="line">                    let lo1 &#x3D; local.longitude</span><br><span class="line">                    return uniCloud.callFunction(&#123;</span><br><span class="line">                        name:&#39;stores&#39;,</span><br><span class="line">                        </span><br><span class="line">                    &#125;).then(res &#x3D;&gt;&#123;</span><br><span class="line">                        let temp &#x3D; []</span><br><span class="line">                        let l &#x3D; res.result.length</span><br><span class="line">                        if(l &gt;&#x3D; 1)&#123;</span><br><span class="line">                            for( let i &#x3D; 0;i &lt; l; i++ ) &#123;</span><br><span class="line">                                let element &#x3D;  res.result[i];</span><br><span class="line">                                let d &#x3D; this.distance(element.latitude,element.longitude,la1,lo1)</span><br><span class="line">                                element.distance &#x3D; d</span><br><span class="line">                                temp.push(element)</span><br><span class="line">                            &#125;;</span><br><span class="line">                                this.storeData &#x3D; temp.sort(function(a,b)&#123;</span><br><span class="line">                                    return a.distance - b.distance</span><br><span class="line">                                &#125;)</span><br><span class="line">                                </span><br><span class="line">                                return this.storeData</span><br><span class="line">                                </span><br><span class="line">                        &#125;</span><br><span class="line">                        </span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;).then(resMap &#x3D;&gt; &#123;</span><br><span class="line">                    this.latitude &#x3D; resMap[0].latitude</span><br><span class="line">                    this.longitude &#x3D; resMap[0].longitude</span><br><span class="line">                    let map &#x3D;[]</span><br><span class="line">                    let len &#x3D;resMap.length</span><br><span class="line">                    if(len &gt;&#x3D; 1)&#123;</span><br><span class="line">                        for(let i&#x3D;0; i&lt;len; i++) &#123;</span><br><span class="line">                            let maps &#x3D; &#123;&#125;</span><br><span class="line">                            maps.id &#x3D; i</span><br><span class="line">                            maps.latitude &#x3D; resMap[i].latitude</span><br><span class="line">                            maps.longitude &#x3D; resMap[i].longitude</span><br><span class="line">                            maps.iconPath &#x3D;&#39;&#x2F;static&#x2F;images&#x2F;logo.png&#39;</span><br><span class="line">                            maps.width &#x3D; 30</span><br><span class="line">                            maps.height &#x3D; 30</span><br><span class="line">                            maps.callout &#x3D; &#123;&#39;content&#39;:resMap[i].name,&#39;display&#39;:&#39;ALWAYS&#39;&#125;</span><br><span class="line">                            map.push(maps)</span><br><span class="line">                        &#125;</span><br><span class="line">                        </span><br><span class="line">                        this.markers &#x3D; map</span><br><span class="line">                        </span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            </span><br><span class="line">                </span><br><span class="line">        &#125;,</span><br></pre></td></tr></table></figure>

<p>在cloudfunctions中创建</p>
<p>stores云函数，返回门店信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#39;use strict&#39;;</span><br><span class="line"></span><br><span class="line">const db &#x3D; uniCloud.database()</span><br><span class="line">exports.main &#x3D; async (event, context) &#x3D;&gt; &#123;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">  const res &#x3D; await db.collection(&#39;stores&#39;).get()</span><br><span class="line">    return res.data</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h3 id="点餐菜单开发"><a href="#点餐菜单开发" class="headerlink" title="点餐菜单开发"></a>点餐菜单开发</h3><h4 id="导航模块开发"><a href="#导航模块开发" class="headerlink" title="导航模块开发"></a>导航模块开发</h4><p>自取和外卖切换到点餐菜单</p>
<p>自取：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 点击后跳转点餐</span><br><span class="line">            tapStore(store)&#123;</span><br><span class="line">                this.SET_ORDERTYPE(&#39;takein&#39;)</span><br><span class="line">                            this.SET_STORE(store)</span><br><span class="line">                            uni.switchTab(&#123;</span><br><span class="line">                                url:&#39;..&#x2F;menu&#x2F;menu&#39;</span><br><span class="line">                            &#125;)</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>



<p>外卖：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 点击跳转到点餐界面</span><br><span class="line">            tapAddress(address)&#123;</span><br><span class="line">            this.SET_ADDRESS(address)</span><br><span class="line">                    this.SET_ORDERTYPE(&#39;takeout&#39;)</span><br><span class="line">                    uni.switchTab(&#123;</span><br><span class="line">                        url:&#39;..&#x2F;menu&#x2F;menu&#39;</span><br><span class="line">                    &#125;)</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<p>menu界面nav</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;view class&#x3D;&quot;nav&quot;&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;header&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;left&quot; v-if&#x3D;&quot;orderType &#x3D;&#x3D; &#39;takein&#39;&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;store-name&quot;&gt;</span><br><span class="line">                            &lt;text&gt;&#123;&#123; choseStore.name &#125;&#125;&lt;&#x2F;text&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;iconfont icon-arrow-right&quot;&gt;&lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;store-location&quot;&gt;</span><br><span class="line">                            &lt;image src&#x3D;&#39;&#x2F;static&#x2F;images&#x2F;order&#x2F;location.png&#39; style&#x3D;&quot;width: 30rpx; height: 30rpx;&quot; class&#x3D;&quot;mr-10&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                            &lt;text&gt;距离您 &#123;&#123; choseStore.distance &#125;&#125;&lt;&#x2F;text&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;left overflow-hidden&quot; v-else&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;d-flex align-items-center overflow-hidden&quot;&gt;</span><br><span class="line">                            &lt;image src&#x3D;&#39;&#x2F;static&#x2F;images&#x2F;order&#x2F;location.png&#39; style&#x3D;&quot;width: 30rpx; height: 30rpx;&quot; class&#x3D;&quot;mr-10&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;font-size-extra-lg text-color-base font-weight-bold text-truncate&quot;&gt;</span><br><span class="line">                                &#123;&#123; choseAddress.street &#125;&#125;</span><br><span class="line">                            &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;font-size-sm text-color-assist overflow-hidden text-truncate&quot;&gt;</span><br><span class="line">                            由&lt;text class&#x3D;&quot;text-color-base&quot; style&#x3D;&quot;margin: 0 10rpx&quot;&gt;&#123;&#123; choseAddress.store_name &#125;&#125;配送&lt;&#x2F;text&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;right&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;dinein&quot; :class&#x3D;&quot;&#123;active: orderType &#x3D;&#x3D; &#39;takein&#39;&#125;&quot; @tap&#x3D;&quot;SET_ORDERTYPE(&#39;takein&#39;)&quot;&gt;</span><br><span class="line">                            &lt;text&gt;自取&lt;&#x2F;text&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;takeout&quot; :class&#x3D;&quot;&#123;active: orderType &#x3D;&#x3D; &#39;takeout&#39;&#125;&quot; @tap&#x3D;&quot;takout&quot;&gt;</span><br><span class="line">                            &lt;text&gt;外卖&lt;&#x2F;text&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;view class&#x3D;&quot;coupon&quot;&gt;</span><br><span class="line">                    &lt;text class&#x3D;&quot;title&quot;&gt;&quot;霸气mini卡&quot;超级购券活动，赶紧去购买&lt;&#x2F;text&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;iconfont iconarrow-right&quot;&gt;&lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;view&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br></pre></td></tr></table></figure>

<p>切换自取和外卖按钮</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">tapTakein()&#123;</span><br><span class="line">            </span><br><span class="line">            if(this.choseStore) &#123;</span><br><span class="line">                this.SET_ORDERTYPE(&#39;takein&#39;)</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                uni.navigateTo(&#123;</span><br><span class="line">                    url:&#39;..&#x2F;stores&#x2F;stores&#39;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        </span><br><span class="line">        tapTakeOut()&#123;</span><br><span class="line">            if(!this.isLogin)&#123;</span><br><span class="line">                uni.navigateTo(&#123;</span><br><span class="line">                    url:&#39;..&#x2F;login&#x2F;login&#39;</span><br><span class="line">                &#125;)</span><br><span class="line">                </span><br><span class="line">                return</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            uni.navigateTo(&#123;</span><br><span class="line">                url:&#39;..&#x2F;address&#x2F;address&#39;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;,</span><br><span class="line">        </span><br><span class="line">        tapStore() &#123;</span><br><span class="line">            uni.navigateTo(&#123;</span><br><span class="line">                url:&#39;..&#x2F;stores&#x2F;stores&#39;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<h4 id="加载菜单goods数据"><a href="#加载菜单goods数据" class="headerlink" title="加载菜单goods数据"></a>加载菜单goods数据</h4><p>unicloud部分</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#39;use strict&#39;;</span><br><span class="line">const db &#x3D; uniCloud.database()</span><br><span class="line">exports.main &#x3D; async (event, context) &#x3D;&gt; &#123;</span><br><span class="line">    const res &#x3D; await db.collection(&#39;category&#39;).aggregate().lookup(&#123;</span><br><span class="line">        from:&#39;goods&#39;,</span><br><span class="line">        localField:&#39;goods_type&#39;,</span><br><span class="line">        foreignField:&#39;goods_type&#39;,</span><br><span class="line">        as:&#39;goods_list&#39;</span><br><span class="line">    &#125;).end()</span><br><span class="line">    return res</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>点餐展示部分</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&lt;scroll-view class&#x3D;&quot;menus&quot; :scroll-into-view&#x3D;&quot;menuScrollIntoView&quot; scroll-with-animation scroll-y&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;wrapper&quot;&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;menu&quot; :id&#x3D;&quot;&#96;menu-$&#123;item._id&#125;&#96;&quot; :class&#x3D;&quot;&#123;&#39;current&#39;: item._id &#x3D;&#x3D;&#x3D; currentCateId&#125;&quot; v-for&#x3D;&quot;(item, index) in goods&quot; </span><br><span class="line">                        :key&#x3D;&quot;index&quot; @tap&#x3D;&quot;handleMenuTap(item._id)&quot;&gt;</span><br><span class="line">                            &lt;text&gt;&#123;&#123; item.name &#125;&#125;&lt;&#x2F;text&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;dot&quot; v-show&#x3D;&quot;menuCartNum(item._id)&quot;&gt;&#123;&#123; menuCartNum(item._id) &#125;&#125;&lt;&#x2F;view&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;scroll-view&gt;</span><br><span class="line">                &lt;!-- goods list begin --&gt;</span><br><span class="line">                &lt;scroll-view class&#x3D;&quot;goods&quot; scroll-with-animation scroll-y :scroll-top&#x3D;&quot;cateScrollTop&quot; @scroll&#x3D;&quot;handleGoodsScroll&quot;&gt;</span><br><span class="line">                    &lt;view class&#x3D;&quot;wrapper&quot;&gt;</span><br><span class="line">                        &lt;swiper class&#x3D;&quot;ads&quot; id&#x3D;&quot;ads&quot; autoplay :interval&#x3D;&quot;3000&quot; indicator-dots&gt;</span><br><span class="line">                            &lt;swiper-item v-for&#x3D;&quot;(item, index) in ads&quot; :key&#x3D;&#39;index&#39;&gt;</span><br><span class="line">                                &lt;image :src&#x3D;&quot;item.image&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                            &lt;&#x2F;swiper-item&gt;</span><br><span class="line">                        &lt;&#x2F;swiper&gt;</span><br><span class="line">                        &lt;view class&#x3D;&quot;list&quot;&gt;</span><br><span class="line">                            &lt;!-- category begin --&gt;</span><br><span class="line">                            &lt;view class&#x3D;&quot;category&quot; v-for&#x3D;&quot;(item, index) in goods&quot; :key&#x3D;&quot;index&quot; :id&#x3D;&quot;&#96;cate-$&#123;item.id&#125;&#96;&quot;&gt;</span><br><span class="line">                                &lt;view class&#x3D;&quot;title&quot;&gt;</span><br><span class="line">                                    &lt;text&gt;&#123;&#123; item.name &#125;&#125;&lt;&#x2F;text&gt;</span><br><span class="line">                                    &lt;image :src&#x3D;&quot;item.icon&quot; class&#x3D;&quot;icon&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                                &lt;&#x2F;view&gt;</span><br><span class="line">                                &lt;view class&#x3D;&quot;items&quot;&gt;</span><br><span class="line">                                    &lt;!-- 商品 begin --&gt;</span><br><span class="line">                                    &lt;view class&#x3D;&quot;good&quot; v-for&#x3D;&quot;(good, key) in item.goods_list&quot; :key&#x3D;&quot;key&quot;&gt;</span><br><span class="line">                                        &lt;image :src&#x3D;&quot;good.images&quot; class&#x3D;&quot;image&quot; @tap&#x3D;&quot;showGoodDetailModal(item, good)&quot;&gt;&lt;&#x2F;image&gt;</span><br><span class="line">                                        &lt;view class&#x3D;&quot;right&quot;&gt;</span><br><span class="line">                                            &lt;text class&#x3D;&quot;name&quot;&gt;&#123;&#123; good.name &#125;&#125;&lt;&#x2F;text&gt;</span><br><span class="line">                                            &lt;text class&#x3D;&quot;tips&quot;&gt;&#123;&#123; good.content &#125;&#125;&lt;&#x2F;text&gt;</span><br><span class="line">                                            &lt;view class&#x3D;&quot;price_and_action&quot;&gt;</span><br><span class="line">                                                &lt;text class&#x3D;&quot;price&quot;&gt;￥&#123;&#123; good.price &#125;&#125;&lt;&#x2F;text&gt;</span><br><span class="line">                                                &lt;view class&#x3D;&quot;btn-group&quot; v-if&#x3D;&quot;good.property&quot;&gt;</span><br><span class="line">                                                    &lt;button type&#x3D;&quot;primary&quot; class&#x3D;&quot;btn property_btn&quot; hover-class&#x3D;&quot;none&quot;</span><br><span class="line">                                                     size&#x3D;&quot;mini&quot; @tap&#x3D;&quot;showGoodDetailModal(item, good)&quot;&gt;</span><br><span class="line">                                                        选规格</span><br><span class="line">                                                    &lt;&#x2F;button&gt;</span><br><span class="line">                                                    &lt;view class&#x3D;&quot;dot&quot; v-show&#x3D;&quot;goodCartNum(good._id)&quot;&gt;&#123;&#123; goodCartNum(good._id) &#125;&#125;&lt;&#x2F;view&gt;</span><br><span class="line">                                                &lt;&#x2F;view&gt;</span><br><span class="line">                                                &lt;view class&#x3D;&quot;btn-group&quot; v-else&gt;</span><br><span class="line">                                                    &lt;button type&#x3D;&quot;default&quot; v-show&#x3D;&quot;goodCartNum(good._id)&quot; plain class&#x3D;&quot;btn reduce_btn&quot;</span><br><span class="line">                                                     size&#x3D;&quot;mini&quot; hover-class&#x3D;&quot;none&quot; @tap&#x3D;&quot;handleReduceFromCart(item, good)&quot;&gt;</span><br><span class="line">                                                        &lt;view class&#x3D;&quot;iconfont icon-sami-select&quot;&gt;&lt;&#x2F;view&gt;</span><br><span class="line">                                                    &lt;&#x2F;button&gt;</span><br><span class="line">                                                    &lt;view class&#x3D;&quot;number&quot; v-show&#x3D;&quot;goodCartNum(good._id)&quot;&gt;&#123;&#123; goodCartNum(good._id) &#125;&#125;&lt;&#x2F;view&gt;</span><br><span class="line">                                                    &lt;button type&#x3D;&quot;primary&quot; class&#x3D;&quot;btn add_btn&quot; size&#x3D;&quot;min&quot; hover-class&#x3D;&quot;none&quot; </span><br><span class="line">                                                        @tap&#x3D;&quot;handleAddToCart(item, good, 1)&quot;&gt;</span><br><span class="line">                                                        &lt;view class&#x3D;&quot;iconfont icon-add-select&quot;&gt;&lt;&#x2F;view&gt;</span><br><span class="line">                                                    &lt;&#x2F;button&gt;</span><br><span class="line">                                                &lt;&#x2F;view&gt;</span><br><span class="line">                                            &lt;&#x2F;view&gt;</span><br><span class="line">                                        &lt;&#x2F;view&gt;</span><br><span class="line">                                    &lt;&#x2F;view&gt;</span><br><span class="line">                                    &lt;!-- 商品 end --&gt;</span><br><span class="line">                                &lt;&#x2F;view&gt;</span><br><span class="line">                            &lt;&#x2F;view&gt;</span><br><span class="line">                            &lt;!-- category end --&gt;</span><br><span class="line">                        &lt;&#x2F;view&gt;</span><br><span class="line">                    &lt;&#x2F;view&gt;</span><br><span class="line">                &lt;&#x2F;scroll-view&gt;</span><br><span class="line">                &lt;!-- goods list end --&gt;</span><br><span class="line">            &lt;&#x2F;view&gt;</span><br><span class="line">            &lt;!-- content end --&gt;</span><br></pre></td></tr></table></figure>

</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">王大合</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2020/ckdkvis4c000au4nlauyg5q3k/">http://yoursite.com/2020/ckdkvis4c000au4nlauyg5q3k/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com" target="_blank">王大合</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2020/ckdkvis2t0001u4nlhl7d1oso/"><img class="next-cover" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Hexo-theme-butterfly修改调整教程</div></div></a></div></nav></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By 王大合</div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>湘ICP备16002296号</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></body></html>